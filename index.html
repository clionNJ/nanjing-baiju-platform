<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>江苏国家级戏曲类非遗数字平台</title>
    <!-- 使用国内CDN加速，如果失败则回退到原CDN -->
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
          onerror="this.onerror=null;this.href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css'">
    
    <!-- 色盲友好的SVG滤镜定义 -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <filter id="protanopia-filter">
            <feColorMatrix type="matrix" values="
                0.567, 0.433, 0,     0, 0
                0.558, 0.442, 0,     0, 0
                0,     0.242, 0.758, 0, 0
                0,     0,     0,     1, 0
            "/>
        </filter>
        <filter id="deuteranopia-filter">
            <feColorMatrix type="matrix" values="
                0.625, 0.375, 0,     0, 0
                0.7,   0.3,   0,     0, 0
                0,     0.3,   0.7,   0, 0
                0,     0,     0,     1, 0
            "/>
        </filter>
        <filter id="tritanopia-filter">
            <feColorMatrix type="matrix" values="
                0.95, 0.05,  0,     0, 0
                0,    0.433, 0.567, 0, 0
                0,    0.475, 0.525, 0, 0
                0,    0,     0,     1, 0
            "/>
        </filter>
    </svg>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        :root {
            --primary:  #ff9800;
            --primary-dark: #e65100;
            --secondary: #ff5722;
            --accent:  #ffc107; 
            --light: #f5f5f5;
            --dark: #2c3e50;
            --text: #333;
            --text-light: #777;
            --success: #2ecc71;
            --warning: #f1c40f;
            --danger: #e74c3c;
        }

   body {
            /* 背景图片设置 */
            background-image: url('images/4ED9557E923B0B49B6F4A467C16AB514.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            color: var(--text);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
        }

        /* 添加半透明遮罩层，确保文字可读性 */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0);
            z-index: -1;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }

        .page {
            padding: 40px;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #8B4513;
            font-size: 2.5rem;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-dark);
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        p {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.1rem;
            color: var(--text-light);
            line-height: 1.6;
        }

        /* 语言选择页面样式 */
        .language-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 固定3列 */
    gap: 20px;
    margin-top: 40px;
}

        .language-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .language-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--primary);
        }

        .language-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.15);
            border-color: var(--primary);
        }

        .language-card img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 15px;
            border-radius: 50%;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .language-card h3 {
            color: var(--dark);
            font-size: 1.4rem;
        }

        /* 功能页面样式 */
       .feature-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr); /* 固定2列 */
    gap: 25px;
    margin-top: 30px;
}
        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid var(--primary);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--primary);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .feature-card i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
            display: block;
        }

        .feature-card h3 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.4rem;
        }

        .feature-card p {
            font-size: 0.95rem;
            color: var(--text-light);
            margin-bottom: 0;
            text-align: center;
        }

        .feature-card .badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 12px 30px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .back-btn {
            background: var(--text-light);
            margin-right: 10px;
        }

        .back-btn:hover {
            background: var(--dark);
        }

        .button-container {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }

        /* 阿拉伯语特殊样式 */
        .arabic-text {
            direction: rtl;
            font-family: 'Segoe UI', Tahoma, 'Arabic Typesetting', sans-serif;
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            .container {
                border-radius: 10px;
            }
            
            .page {
                padding: 25px 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .language-grid, .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .button-container {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                margin: 5px 0;
            }
        }
        

        /* 顶部导航 */
        .header {
            background: var(--primary);
            color: white;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .logo i {
            font-size: 2rem;
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .nav-links a:hover {
            background: rgba(255,255,255,0.2);
        }

        /* 助残功能控制按钮样式 */
        .accessibility-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            gap: 10px;
        }

        .accessibility-btn {
            background: var(--primary);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .accessibility-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        /* 关怀模式（简洁语言 + 低认知负担排版） */
        .care-mode {
            --care-font-size: 18px;
            --care-line-height: 1.9;
            --care-letter-spacing: 0.3px;
        }
        .care-mode body,
        .care-mode .page,
        .care-mode p,
        .care-mode li,
        .care-mode span,
        .care-mode a,
        .care-mode button {
            font-size: var(--care-font-size) !important;
            line-height: var(--care-line-height) !important;
            letter-spacing: var(--care-letter-spacing) !important;
        }
        .care-mode h1 { font-size: 1.8em !important; }
        .care-mode h2 { font-size: 1.6em !important; }
        .care-mode h3 { font-size: 1.35em !important; }
        .care-mode .container,
        .care-mode .page {
            max-width: 880px;
        }
        /* 隐藏装饰性元素（为装饰加 data-decorative="true" 可在关怀模式隐藏） */
        .care-mode [data-decorative="true"] {
            display: none !important;
        }
        /* 强化分隔与可读性 */
        .care-mode p + p {
            margin-top: 0.8em;
        }
        .care-mode .btn {
            min-height: 44px;
            min-width: 44px;
        }

        /* 语音模式询问弹窗 */
        .voice-intro-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
            width: 90%;
            max-width: 520px;
            z-index: 1200;
            padding: 22px 24px;
            display: none;
        }
        .voice-intro-modal h3 {
            margin: 0 0 10px 0;
            color: var(--primary);
            font-size: 1.25rem;
        }
        .voice-intro-modal p {
            margin: 8px 0 16px 0;
        }
        .voice-intro-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 10px;
        }
        .voice-intro-actions .btn {
            padding: 10px 14px;
            border-radius: 8px;
        }
        .voice-intro-hint {
            font-size: 0.9rem;
            color: #666;
        }
        .overlay.active { display: block; }

        /* 语音识别状态指示器 */
        .voice-status {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            z-index: 1000;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        /* 高对比度模式样式 */
        .high-contrast {
            filter: contrast(1.5) saturate(1.5);
        }

        .high-contrast .feature-card,
        .high-contrast .language-card {
            border: 3px solid yellow !important;
            background-color: black !important;
            color: white !important;
        }

        .high-contrast .btn {
            background-color: yellow !important;
            color: black !important;
            border: 2px solid black !important;
        }

        /* 社会治理浮动入口按钮 */
        .governance-fab {
            position: fixed;
            right: 30px;
            bottom: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .governance-fab-main {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            font-size: 24px;
        }

        .governance-fab-main:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .governance-fab-main.active {
            transform: rotate(45deg);
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .governance-fab-menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .governance-fab-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
            pointer-events: all;
        }

        .governance-fab-item {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            color: var(--dark);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            font-size: 20px;
            position: relative;
        }

        .governance-fab-item:hover {
            transform: scale(1.15);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .governance-fab-item::after {
            content: attr(data-label);
            position: absolute;
            right: 60px;
            white-space: nowrap;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .governance-fab-item:hover::after {
            opacity: 1;
            visibility: visible;
        }

        .governance-fab-item.dashboard {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .governance-fab-item.participation {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        @media (max-width: 768px) {
            .governance-fab {
                right: 20px;
                bottom: 20px;
            }

            .governance-fab-main {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }

            .governance-fab-item {
                width: 45px;
                height: 45px;
                font-size: 18px;
            }

            .governance-fab-item::after {
                display: none;
            }
        }

        .high-contrast h1, 
        .high-contrast h2, 
        .high-contrast h3, 
        .high-contrast h4, 
        .high-contrast h5, 
        .high-contrast h6 {
            color: yellow !important;
        }

        .high-contrast p {
            color: white !important;
        }

        /* 色盲友好调色板 */
        .colorblind-protanopia {
            /* 红绿色盲（第一种）调色板 */
        }

        .colorblind-deuteranopia {
            /* 红绿色盲（第二种）调色板 */
        }

        .colorblind-tritanopia {
            /* 蓝黄色盲调色板 */
        }

        /* 对比度菜单样式 */
        .contrast-menu {
            position: absolute;
            top: 70px;
            right: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
            z-index: 1000;
            min-width: 200px;
            overflow: hidden;
        }

        .contrast-menu .menu-item {
            padding: 12px 16px;
            cursor: pointer;
            transition: background-color 0.2s;
            border-bottom: 1px solid #eee;
        }

        .contrast-menu .menu-item:last-child {
            border-bottom: none;
        }

        .contrast-menu .menu-item:hover {
            background-color: #f5f5f5;
        }

        /* 色盲友好的具体调色板实现 */
        .colorblind-protanopia {
            filter: url(#protanopia-filter);
        }

        .colorblind-deuteranopia {
            filter: url(#deuteranopia-filter);
        }

        .colorblind-tritanopia {
            filter: url(#tritanopia-filter);
        }

        /* 功能详情区域 */
        .feature-detail {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            z-index: 1000;
        }

        .feature-detail.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .feature-detail h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.6rem;
        }

        .feature-detail p {
            text-align: left;
            margin-bottom: 20px;
        }

        .feature-detail img {
            width: 100%;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--text-light);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }

        .close-btn:hover {
            background: var(--danger);
        }

        /* 虚拟人物区域 */
        /* 虚拟人物动画样式 */
.character-animation {
    width: 200px;
    height: 300px;
    background: linear-gradient(135deg, #8e44ad 0%, #3498db 100%);
    border-radius: 20px;
    position: relative;
    margin: 0 auto;
}

.character-face {
    position: absolute;
    top: 60px;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
}

.eyes {
    display: flex;
    justify-content: space-between;
    margin-bottom: 30px;
}

.eye {
    width: 20px;
    height: 20px;
    background: #333;
    border-radius: 50%;
    animation: blink 4s infinite;
}

.mouth {
    width: 40px;
    height: 15px;
    background: #e74c3c;
    border-radius: 0 0 20px 20px;
    margin: 0 auto;
    transition: all 0.3s ease;
}

/* 嘴巴说话动画 */
.mouth.speaking {
    animation: speak 0.3s infinite alternate;
}

/* 眨眼动画 */
@keyframes blink {
    0%, 90%, 100% { height: 20px; }
    95% { height: 2px; }
}

/* 说话动画 */
@keyframes speak {
    0% { height: 5px; }
    100% { height: 15px; }
}

.character-controls {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 20px;
    flex-wrap: wrap;
}

.character-controls .btn {
    padding: 8px 15px;
    font-size: 0.9rem;
}

.performance-text {
    text-align: center;
    margin-top: 15px;
    font-size: 1.1rem;
    color: var(--primary);
    min-height: 30px;
}

.conversation-panel {
    background: rgba(245, 245, 245, 0.9);
    border-radius: 15px;
    padding: 20px;
    margin-top: 30px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.conversation-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 15px;
    flex-wrap: wrap;
}

.conversation-toggles {
    display: flex;
    align-items: center;
    gap: 15px;
    flex-wrap: wrap;
}

.detected-language {
    font-size: 0.9rem;
    color: var(--text-light);
    display: flex;
    align-items: center;
    gap: 5px;
}

.toggle {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 0.9rem;
    color: var(--text-light);
}

.toggle input {
    accent-color: var(--primary);
}

.conversation-status {
    min-height: 20px;
    font-size: 0.9rem;
    color: var(--primary);
}

.chat-log {
    max-height: 260px;
    overflow-y: auto;
    background: white;
    border-radius: 10px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    box-shadow: inset 0 2px 6px rgba(0,0,0,0.04);
}

.chat-message {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.chat-message.user {
    align-items: flex-end;
}

.chat-message.assistant {
    align-items: flex-start;
}

.chat-name {
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--text-light);
}

.chat-bubble {
    background: rgba(255, 152, 0, 0.12);
    color: var(--dark);
    padding: 10px 14px;
    border-radius: 14px;
    max-width: 100%;
    line-height: 1.5;
    box-shadow: 0 2px 6px rgba(0,0,0,0.06);
}

.chat-message.user .chat-bubble {
    background: rgba(46, 204, 113, 0.18);
}

.conversation-input {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.conversation-input input {
    flex: 1;
    min-width: 180px;
    padding: 10px 12px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
}

.voice-btn {
    background: var(--secondary);
}

.voice-btn.listening {
    background: var(--danger);
}

.arabic-text .conversation-panel {
    direction: rtl;
    text-align: right;
}

.arabic-text .conversation-input {
    flex-direction: row-reverse;
}

.arabic-text .conversation-toggles {
    flex-direction: row-reverse;
    justify-content: flex-start;
}

.chat-message[dir="rtl"] {
    align-items: flex-end;
}

.chat-message[dir="rtl"] .chat-bubble {
    text-align: right;
}
        .virtual-character {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .character-container {
            width: 300px;
            height: 400px;
            background: #f5f5f5;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

       .character {
    background-image: url('images/3DB4A5D6F35C44B34ECBC88BD7D20D37.jpg');
    background-size: cover;
    background-position: center;
}

        .character-head {
            width: 80px;
            height: 80px;
            background: #f1c40f;
            border-radius: 50%;
            position: absolute;
            top: 50px;
            left: 60px;
        }

        .character-body {
            width: 120px;
            height: 150px;
            background: #3498db;
            border-radius: 10px;
            position: absolute;
            top: 140px;
            left: 40px;
        }

        /* 跟唱评分区域 */
        .singing-interface {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .lyrics-container {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            min-height: 100px;
        }

        .lyric-line {
            margin: 10px 0;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .lyric-line.correct {
            background: rgba(46, 204, 113, 0.2);
            border-left: 3px solid var(--success);
        }

        .lyric-line.incorrect {
            background: rgba(231, 76, 60, 0.2);
            border-left: 3px solid var(--danger);
        }

        .score-display {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
        }

        .score-item {
            text-align: center;
            flex: 1;
        }

        .score-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        /* 虚拟场景区域 */
        .virtual-scene {
            width: 100%;
            height: 300px;
            background: #f5f5f5;
            border-radius: 15px;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .scene-content {
            text-align: center;
            padding: 20px;
        }

        /* 知识库区域 */
        .knowledge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .knowledge-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .knowledge-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }

        .knowledge-card i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        /* AI创作区域 */
        .ai-creation {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .theme-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 1rem;
        }

        .language-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .lang-option {
            padding: 8px 15px;
            background: #e0e0e0;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lang-option.active {
            background: var(--primary);
            color: white;
        }

        .creation-result {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            min-height: 100px;
        }
/* 在CSS样式中添加 */
/* 意见反馈样式 */
.feedback-interface {
    background: #f5f5f5;
    border-radius: 15px;
    padding: 20px;
    margin: 20px 0;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--dark);
}

.form-input, .form-select, .form-textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.form-input:focus, .form-select:focus, .form-textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.1);
}

.form-textarea {
    resize: vertical;
    min-height: 120px;
}

.rating-stars {
    display: flex;
    gap: 5px;
    margin: 10px 0;
}

.star {
    font-size: 2rem;
    color: #e0e0e0;
    cursor: pointer;
    transition: all 0.3s ease;
}

.star:hover,
.star.active {
    color: var(--warning);
    transform: scale(1.1);
}

.star.hover {
    color: var(--warning);
    opacity: 0.8;
    transform: scale(1.1);
}

.rating-text {
    text-align: center;
    color: var(--text-light);
    font-size: 0.9rem;
    margin-top: 5px;
}

.feedback-list {
    background: white;
    border-radius: 10px;
    padding: 15px;
    max-height: 200px;
    overflow-y: auto;
}

.feedback-item {
    padding: 10px;
    border-bottom: 1px solid #eee;
    margin-bottom: 10px;
}

.feedback-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
}

.feedback-item .title {
    font-weight: 600;
    color: var(--dark);
    margin-bottom: 5px;
}

.feedback-item .meta {
    font-size: 0.8rem;
    color: var(--text-light);
    display: flex;
    justify-content: space-between;
}

.feedback-item .status {
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 0.7rem;
    font-weight: 600;
}

.status.pending {
    background: #fff3cd;
    color: #856404;
}

.status.replied {
    background: #d1ecf1;
    color: #0c5460;
}
        /* 遮罩层 */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

        /* 选择曲种页面：2列对称布局 */
        #genre-page .language-grid {
            grid-template-columns: repeat(2, 1fr) !important;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        @media (max-width: 768px) {
            /* 选择曲种页面在小屏幕上保持2列布局 */
            #genre-page .language-grid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }
    </style>
</head>
<body>
    <!-- 遮罩层 -->
    <div class="overlay" id="overlay"></div>

    <!-- 语音模式询问弹窗 -->
    <div id="voice-intro-modal" class="voice-intro-modal" role="dialog" aria-modal="true" aria-labelledby="voice-intro-title" aria-describedby="voice-intro-desc">
        <h3 id="voice-intro-title" data-simple="开启语音模式？">是否需要开启语音模式以便通过语音快速操作？</h3>
        <p id="voice-intro-desc" data-simple="你可以说“需要”或“不要”。">你可以说“需要/开启/是”进入语音模式，或说“不需要/不用/否”关闭。若保持沉默，数秒后自动关闭。</p>
        <p class="voice-intro-hint" data-simple="也可点按钮">也可直接点击下面的按钮：</p>
        <div class="voice-intro-actions">
            <button id="voice-intro-yes" class="btn" data-simple="需要">需要语音模式</button>
            <button id="voice-intro-no" class="btn back-btn" data-simple="不需要">暂不需要</button>
        </div>
    </div>

    <div class="container">
        <!-- 助残功能控制按钮 -->
        <div class="accessibility-controls">
            <button id="voice-control-btn" class="accessibility-btn" title="语音控制">
                <i class="fas fa-microphone"></i>
            </button>
            <button id="contrast-control-btn" class="accessibility-btn" title="对比度调节">
                <i class="fas fa-adjust"></i>
            </button>
            <button id="care-mode-btn" class="accessibility-btn" title="关怀模式（简洁语言）">
                <i class="fas fa-hand-holding-heart"></i>
            </button>
        </div>
        
        <!-- 社会治理浮动入口按钮 -->
        <div class="governance-fab">
            <div class="governance-fab-menu" id="governance-fab-menu">
                <button class="governance-fab-item dashboard" data-label="社会治理数据大屏" onclick="showFeatureDetail('feature7')" title="社会治理数据大屏">
                    <i class="fas fa-chart-line"></i>
                </button>
                <button class="governance-fab-item participation" data-label="公众参与与协同治理" onclick="showFeatureDetail('feature8')" title="公众参与与协同治理">
                    <i class="fas fa-users"></i>
                </button>
            </div>
            <button class="governance-fab-main" id="governance-fab-main" onclick="toggleGovernanceFab()" title="社会治理">
                <i class="fas fa-shield-alt"></i>
            </button>
        </div>
        
        <!-- 语音识别状态指示器 -->
        <div id="voice-status" class="voice-status">
            <span id="voice-status-text">正在聆听...</span>
        </div>
        
        <!-- 顶部导航 -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-dragon"></i>
                <span>江苏国家级戏曲类非遗数字平台</span>
            </div>
        </div>
        
        <!-- 语言选择页面 -->
        <div id="language-page" class="page active">
            <h1 data-simple="选择语言">选择您的语言 / Select Your Language</h1>
            <p data-simple="请选择一种语言">请选择您偏好的语言界面 / Please select your preferred language interface</p>
            
            <div class="language-grid">
                <div class="language-card" onclick="selectLanguage('zh-CN')">
                    <img src="https://flagcdn.com/w80/cn.png" 
                         onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/country-flag-icons@3.5.0/3x2/CN.svg'" 
                         alt="中文">
                    <h3>中文</h3>
                </div>
                <div class="language-card" onclick="selectLanguage('en')">
                    <img src="https://flagcdn.com/w80/us.png" 
                         onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/country-flag-icons@3.5.0/3x2/US.svg'" 
                         alt="English">
                    <h3>English</h3>
                </div>
                <div class="language-card" onclick="selectLanguage('es')">
                    <img src="https://flagcdn.com/w80/es.png" 
                         onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/country-flag-icons@3.5.0/3x2/ES.svg'" 
                         alt="Español">
                    <h3>Español</h3>
                </div>
                <div class="language-card" onclick="selectLanguage('fr')">
                    <img src="https://flagcdn.com/w80/fr.png" 
                         onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/country-flag-icons@3.5.0/3x2/FR.svg'" 
                         alt="Français">
                    <h3>Français</h3>
                </div>
                <div class="language-card" onclick="selectLanguage('ja')">
                    <img src="https://flagcdn.com/w80/jp.png" 
                         onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/country-flag-icons@3.5.0/3x2/JP.svg'" 
                         alt="日本語">
                    <h3>日本語</h3>
                </div>
                <div class="language-card" onclick="selectLanguage('ar')">
                    <img src="https://flagcdn.com/w80/sa.png" 
                         onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/npm/country-flag-icons@3.5.0/3x2/SA.svg'" 
                         alt="العربية">
                    <h3>العربية</h3>
                </div>
            </div>

            <div class="button-container" style="margin-top: 16px;">
                <!-- 占位：语言页没有返回按钮 -->
            </div>
        </div>

        <!-- 曲种选择页面（风格与语言选择一致，复用样式） -->
        <div id="genre-page" class="page" style="display: none;">
            <h1 id="genre-page-title" data-simple="选择曲种">请选择曲种</h1>
            <p id="genre-page-desc" data-simple="请选择白局、昆曲、苏州评弹或扬剧">请选择白局、昆曲、苏州评弹或扬剧</p>

            <div class="language-grid">
                <div class="language-card" onclick="selectGenre('baiju')">
                    <i class="fas fa-theater-masks" style="font-size: 42px; color: var(--primary);"></i>
                    <h3 id="genre-option-baiju">白局</h3>
                </div>
                <div class="language-card" onclick="selectGenre('kunqu')">
                    <i class="fas fa-music" style="font-size: 42px; color: var(--primary);"></i>
                    <h3 id="genre-option-kunqu">昆曲</h3>
                </div>
                <div class="language-card" onclick="selectGenre('pintang')">
                    <i class="fas fa-guitar" style="font-size: 42px; color: var(--primary);"></i>
                    <h3 id="genre-option-pintang">苏州评弹</h3>
                </div>
                <div class="language-card" onclick="selectGenre('yangju')">
                    <i class="fas fa-theater-masks" style="font-size: 42px; color: var(--primary);"></i>
                    <h3 id="genre-option-yangju">扬剧</h3>
                </div>
            </div>

            <div class="button-container">
                <button class="btn back-btn" onclick="goBackToLanguageFromGenre()" id="genre-back-btn">返回语言选择</button>
            </div>
        </div>
        
        <!-- 功能页面 -->
        <div id="feature-page" class="page">
            <h1 id="feature-title" data-simple="白局数字平台">江苏国家级戏曲类非遗数字平台</h1>
            <p id="feature-description" data-simple="探索南京白局的数字体验">探索南京白局非遗文化的数字化体验，感受传统与现代科技的完美融合</p>
            
            <div class="feature-grid">
                <div class="feature-card" onclick="showFeatureDetail('feature1')">
                    <i class="fas fa-user-circle"></i>
                    <div class="badge">热门</div>
                    <h3 id="feature1-title" data-simple="虚拟演唱">虚拟传承人演唱展示</h3>
                    <p id="feature1-desc" data-simple="虚拟形象演唱白局">数字化还原的白局传承人虚拟形象，展示传统唱腔与表演</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature2')">
                    <i class="fas fa-microphone-alt"></i>
                    <div class="badge">新功能</div>
                    <h3 id="feature2-title" data-simple="AI跟唱">AI语音跟唱训练</h3>
                    <p id="feature2-desc" data-simple="分析歌声并给出建议">实时分析音高、节奏、发音，提供专业跟唱指导</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature3')">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <h3 id="feature3-title" data-simple="虚拟课堂">虚拟课堂沉浸式教学</h3>
                    <p id="feature3-desc" data-simple="学历史与唱腔">在虚拟场景中学习白局历史与唱腔技巧</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature4')">
                    <i class="fas fa-book-open"></i>
                    <h3 id="feature4-title" data-simple="知识库与展厅">白局知识库与文化展厅</h3>
                    <p id="feature4-desc" data-simple="了解白局的起源与人物">了解白局起源、发展、代表人物等丰富文化知识</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature5')">
                    <i class="fas fa-paint-brush"></i>
                    <div class="badge">创意</div>
        
        <h3 id="feature5-title" data-simple="AI创作">AI创作与分享中心</h3>
        <p id="feature5-desc" data-simple="生成唱词旋律并分享">AI自动生成白局唱词与旋律，一键分享至社交平台</p>
    </div>
 
    <div class="feature-card" onclick="showFeatureDetail('feature6')">
        <i class="fas fa-comment-dots"></i>
        <div class="badge">互动</div>
        <h3 id="feature6-title" data-simple="意见反馈">意见与反馈</h3>
        <p id="feature6-desc" data-simple="欢迎给我们建议">提出宝贵建议，帮助我们改进平台体验</p>
    </div>
</div>
            <div class="button-container">
                <button class="btn back-btn" onclick="goBackToLanguage()" id="back-btn" data-simple="返回语言">返回语言选择</button>
                <button class="btn" id="help-btn" onclick="showHelp()" data-simple="帮助">获取帮助</button>
            </div>
        </div>

        <!-- 功能页面：昆曲 -->
        <div id="feature-page-kunqu" class="page" style="display: none;">
            <h1 data-simple="昆曲数字平台">昆曲非遗文化数字平台</h1>
            <p data-simple="探索昆曲的数字体验">探索昆曲的数字化体验，感受传统与现代科技的完美融合</p>
            <div class="feature-grid">
                <div class="feature-card" onclick="showFeatureDetail('feature1')">
                    <i class="fas fa-user-circle"></i>
                    <div class="badge">热门</div>
                    <h3 data-simple="虚拟演唱">虚拟传承人演唱展示</h3>
                    <p data-simple="虚拟形象演唱昆曲">数字化还原的传承人虚拟形象，展示传统唱腔与表演</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature2')">
                    <i class="fas fa-microphone-alt"></i>
                    <div class="badge">新功能</div>
                    <h3 data-simple="AI跟唱">AI语音跟唱训练</h3>
                    <p data-simple="分析歌声并给出建议">实时分析音高、节奏、发音，提供专业跟唱指导</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature3')">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <h3 data-simple="虚拟课堂">虚拟课堂沉浸式教学</h3>
                    <p data-simple="学历史与唱腔">在虚拟场景中学习昆曲历史与唱腔技巧</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature4')">
                    <i class="fas fa-book-open"></i>
                    <h3 data-simple="知识库与展厅">昆曲知识库与文化展厅</h3>
                    <p data-simple="了解昆曲的起源与人物">了解昆曲起源、发展、代表人物等文化知识</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature5')">
                    <i class="fas fa-paint-brush"></i>
                    <div class="badge">创意</div>
                    <h3 data-simple="AI创作">AI创作与分享中心</h3>
                    <p data-simple="生成唱词旋律并分享">AI自动生成唱词与旋律，一键分享至社交平台</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature6')">
                    <i class="fas fa-comment-dots"></i>
                    <div class="badge">互动</div>
                    <h3 data-simple="意见反馈">意见与反馈</h3>
                    <p data-simple="欢迎给我们建议">提出宝贵建议，帮助我们改进平台体验</p>
                </div>
            </div>
            <div class="button-container">
                <button class="btn back-btn" onclick="goBackToLanguage()" id="back-btn-kunqu" data-simple="返回曲种">返回曲种选择</button>
                <button class="btn" onclick="showHelp()" data-simple="帮助">获取帮助</button>
            </div>
        </div>

        <!-- 功能页面：苏州评弹 -->
        <div id="feature-page-pintang" class="page" style="display: none;">
            <h1 data-simple="评弹数字平台">苏州评弹非遗文化数字平台</h1>
            <p data-simple="探索评弹的数字体验">探索苏州评弹的数字化体验，感受传统与现代科技的完美融合</p>
            <div class="feature-grid">
                <div class="feature-card" onclick="showFeatureDetail('feature1')">
                    <i class="fas fa-user-circle"></i>
                    <div class="badge">热门</div>
                    <h3 data-simple="虚拟演唱">虚拟传承人演唱展示</h3>
                    <p data-simple="虚拟形象演唱评弹">数字化还原的传承人虚拟形象，展示传统唱腔与表演</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature2')">
                    <i class="fas fa-microphone-alt"></i>
                    <div class="badge">新功能</div>
                    <h3 data-simple="AI跟唱">AI语音跟唱训练</h3>
                    <p data-simple="分析歌声并给出建议">实时分析音高、节奏、发音，提供专业跟唱指导</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature3')">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <h3 data-simple="虚拟课堂">虚拟课堂沉浸式教学</h3>
                    <p data-simple="学历史与表演">在虚拟场景中学习评弹历史与表演技巧</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature4')">
                    <i class="fas fa-book-open"></i>
                    <h3 data-simple="知识库与展厅">评弹知识库与文化展厅</h3>
                    <p data-simple="了解评弹的起源与人物">了解评弹起源、发展、代表人物等文化知识</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature5')">
                    <i class="fas fa-paint-brush"></i>
                    <div class="badge">创意</div>
                    <h3 data-simple="AI创作">AI创作与分享中心</h3>
                    <p data-simple="生成唱词旋律并分享">AI自动生成唱词与旋律，一键分享至社交平台</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature6')">
                    <i class="fas fa-comment-dots"></i>
                    <div class="badge">互动</div>
                    <h3 data-simple="意见反馈">意见与反馈</h3>
                    <p data-simple="欢迎给我们建议">提出宝贵建议，帮助我们改进平台体验</p>
                </div>
            </div>
            <div class="button-container">
                <button class="btn back-btn" onclick="goBackToLanguage()" id="back-btn-pintang" data-simple="返回曲种">返回曲种选择</button>
                <button class="btn" onclick="showHelp()" data-simple="帮助">获取帮助</button>
            </div>
        </div>

        <!-- 功能页面：扬剧 -->
        <div id="feature-page-yangju" class="page" style="display: none;">
            <h1 data-simple="扬剧数字平台">扬剧非遗文化数字平台</h1>
            <p data-simple="探索扬剧的数字体验">探索扬剧的数字化体验，感受传统与现代科技的完美融合</p>
            <div class="feature-grid">
                <div class="feature-card" onclick="showFeatureDetail('feature1')">
                    <i class="fas fa-user-circle"></i>
                    <div class="badge">热门</div>
                    <h3 data-simple="虚拟演唱">虚拟传承人演唱展示</h3>
                    <p data-simple="虚拟形象演唱扬剧">数字化还原的传承人虚拟形象，展示传统唱腔与表演</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature2')">
                    <i class="fas fa-microphone-alt"></i>
                    <div class="badge">新功能</div>
                    <h3 data-simple="AI跟唱">AI语音跟唱训练</h3>
                    <p data-simple="分析歌声并给出建议">实时分析音高、节奏、发音，提供专业跟唱指导</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature3')">
                    <i class="fas fa-chalkboard-teacher"></i>
                    <h3 data-simple="虚拟课堂">虚拟课堂沉浸式教学</h3>
                    <p data-simple="学历史与唱腔">在虚拟场景中学习扬剧历史与唱腔技巧</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature4')">
                    <i class="fas fa-book-open"></i>
                    <h3 data-simple="知识库与展厅">扬剧知识库与文化展厅</h3>
                    <p data-simple="了解扬剧的起源与人物">了解扬剧起源、发展、代表人物等文化知识</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature5')">
                    <i class="fas fa-paint-brush"></i>
                    <div class="badge">创意</div>
                    <h3 data-simple="AI创作">AI创作与分享中心</h3>
                    <p data-simple="生成唱词旋律并分享">AI自动生成唱词与旋律，一键分享至社交平台</p>
                </div>
                <div class="feature-card" onclick="showFeatureDetail('feature6')">
                    <i class="fas fa-comment-dots"></i>
                    <div class="badge">互动</div>
                    <h3 data-simple="意见反馈">意见与反馈</h3>
                    <p data-simple="欢迎给我们建议">提出宝贵建议，帮助我们改进平台体验</p>
                </div>
            </div>
            <div class="button-container">
                <button class="btn back-btn" onclick="goBackToLanguage()" id="back-btn-yangju" data-simple="返回曲种">返回曲种选择</button>
                <button class="btn" onclick="showHelp()" data-simple="帮助">获取帮助</button>
            </div>
        </div>
    </div>

    <!-- 功能详情弹窗 - 全部移到容器外部 -->
    <!-- 功能一：虚拟传承人演唱展示 -->
    <div id="feature1-detail" class="feature-detail">
        <button class="close-btn" onclick="closeFeatureDetail('feature1')">&times;</button>
        <h3 id="f1-title">虚拟传承人演唱展示</h3>
        <p id="f1-desc">通过先进的虚拟人技术，我们数字化还原了白局传承人的形象、服饰和动作。虚拟传承人将为您演唱经典白局唱段，展示传统唱腔与表演技巧。</p>
        
        <div class="virtual-character">
            <div class="character-container">
                <!-- 新的虚拟人物动画 -->
                <video id="virtual-video" loop style="width: 300px; height: 400px; border-radius: 20px; object-fit: cover;" preload="metadata">
    				<source src="白局小明视频.mp4" type="video/mp4">
				</video>
            </div>
            
            <!-- 表演状态显示 -->
            <div id="performance-text" class="performance-text"></div>
            
            
            
            <!-- 控制按钮 -->
            <div class="character-controls">
                <button class="btn" id="f1-btn-play1" onclick="playPerformance('song1')">
                    <i class="fas fa-play"></i> 播放《秦淮灯会》
                </button>
                <button class="btn" id="f1-btn-play2" onclick="playPerformance('song2')">
                    <i class="fas fa-play"></i> 播放《金陵四季》
                </button>
                <button class="btn" id="f1-btn-stop" onclick="stopPerformance()">
                    <i class="fas fa-stop"></i> 停止播放
                </button>
            </div>
        </div>
        
		

        <div class="conversation-panel" id="feature1-conversation-panel">
            <div class="conversation-header">
                <h4 id="feature1-conversation-title">互动问答</h4>
                <div class="conversation-toggles">
                    <label class="toggle">
                        <input type="checkbox" id="feature1-auto-detect" checked>
                        <span id="feature1-auto-label">自动识别语言</span>
                    </label>
                    <label class="toggle">
                        <input type="checkbox" id="feature1-tts-toggle" checked>
                        <span id="feature1-tts-label">语音播报</span>
                    </label>
                    <div class="detected-language">
                        <span id="feature1-detected-language-label">识别语言：</span>
                        <span id="feature1-detected-language-text">-</span>
                    </div>
                </div>
            </div>
            <div class="conversation-status" id="feature1-status-text"></div>
            <div id="feature1-chat-log" class="chat-log"></div>
            <div class="conversation-input">
                <button class="btn voice-btn" id="feature1-voice-btn">语音提问</button>
                <input type="text" id="feature1-question-input" placeholder="输入您的问题..." />
                <button class="btn" id="feature1-send-btn">发送</button>
            </div>
        </div>
    </div>

    <!-- 功能二：AI语音跟唱训练 -->
    <div id="feature2-detail" class="feature-detail">
        <button class="close-btn" onclick="closeFeatureDetail('feature2')">&times;</button>
        <h3 id="f2-title" data-simple="AI跟唱">AI语音跟唱训练</h3>
        <p id="f2-desc" data-simple="分析歌声并给出建议">通过AI技术分析您的跟唱表现，实时提供音高、节奏和发音的反馈，帮助您快速掌握白局唱腔技巧。</p>
        
        <div class="singing-interface">
            <h4 id="f2-choose">选择唱段</h4>
            <div style="display: flex; gap: 10px; margin: 15px 0;">
                <button class="btn" id="f2-btn-song1" style="padding: 8px 15px;" onclick="selectTrainingSong('song1')">秦淮灯会</button>
                <button class="btn" id="f2-btn-song2" style="padding: 8px 15px;" onclick="selectTrainingSong('song2')">金陵四季</button>
                <button class="btn" id="f2-btn-song3" style="padding: 8px 15px;" onclick="selectTrainingSong('song3')">南京美食</button>
            </div>
            
            <div class="lyrics-container">
                <h4 id="f2-lyrics-title">歌词</h4>
                <div id="lyrics-display">
                    <div class="lyric-line">秦淮河畔灯火明，</div>
                    <div class="lyric-line">游人如织喜盈盈。</div>
                    <div class="lyric-line">白局一曲传千古，</div>
                    <div class="lyric-line">文化传承永不停。</div>
                </div>
            </div>
            
            <div class="score-display">
                <div class="score-item">
                    <div class="score-value" id="pitch-score">85</div>
                    <div id="label-pitch">音准评分</div>
                </div>
                <div class="score-item">
                    <div class="score-value" id="rhythm-score">78</div>
                    <div id="label-rhythm">节奏评分</div>
                </div>
                <div class="score-item">
                    <div class="score-value" id="pronunciation-score">92</div>
                    <div id="label-pronunciation">发音评分</div>
                </div>
            </div>
            
            <button class="btn" style="width: 100%;" id="start-singing">开始跟唱</button>
        </div>
    </div>

    <!-- 功能三：虚拟课堂沉浸式教学 -->
    <div id="feature3-detail" class="feature-detail">
        <button class="close-btn" onclick="closeFeatureDetail('feature3')">&times;</button>
        <h3 id="f3-title">虚拟课堂沉浸式教学</h3>
        <p id="f3-desc">在虚拟场景中学习白局历史与唱腔技巧，虚拟老师将为您讲解白局知识，并回答您的提问。</p>
        
        <div class="virtual-scene">
            <div class="scene-content">
                <i class="fas fa-university" style="font-size: 4rem; color: var(--primary); margin-bottom: 15px;"></i>
                <h4 id="f3-scene-title">秦淮河畔虚拟课堂</h4>
                <p id="f3-scene-sub">选择您想学习的课程内容</p>
            </div>
        </div>
        
        <div style="margin: 20px 0;">
            <h4 id="f3-courses-title">课程选择</h4>
            <div class="knowledge-grid">
                <div class="knowledge-card" onclick="selectCourse('history')">
                    <i class="fas fa-landmark"></i>
                    <h5 id="f3-course1-title">白局历史</h5>
                    <p id="f3-course1-desc">了解白局的起源与发展历程</p>
                </div>
                <div class="knowledge-card" onclick="selectCourse('technique')">
                    <i class="fas fa-music"></i>
                    <h5 id="f3-course2-title">唱腔技巧</h5>
                    <p id="f3-course2-desc">学习白局的独特唱腔与表演技巧</p>
                </div>
                <div class="knowledge-card" onclick="selectCourse('instruments')">
                    <i class="fas fa-drum"></i>
                    <h5 id="f3-course3-title">乐器介绍</h5>
                    <p id="f3-course3-desc">认识白局表演中使用的传统乐器</p>
                </div>
            </div>
        </div>
        
        <div style="margin: 20px 0;">
            <h4 id="f3-qa-title">语音提问</h4>
            <div style="display: flex; gap: 10px;">
                <input id="f3-qa-input" type="text" placeholder="输入您的问题..." style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <button id="f3-qa-btn" class="btn" style="padding: 10px 20px;">提问</button>
            </div>
        </div>
    </div>

    <!-- 功能四：白局知识库与文化展厅 -->
    <div id="feature4-detail" class="feature-detail">
        <button class="close-btn" onclick="closeFeatureDetail('feature4')">&times;</button>
        <h3 id="f4-title">白局知识库与文化展厅</h3>
        <p id="f4-desc">了解白局起源、发展、代表人物等丰富文化知识，支持多语言展示。</p>
        
        <div class="knowledge-grid">
            <div class="knowledge-card">
                <i class="fas fa-history"></i>
                <h5 id="f4-card1-title">历史渊源</h5>
                <p id="f4-card1-desc">白局起源于明代，是南京地区的传统曲艺形式</p>
                <button id="f4-card1-btn" class="btn" style="padding: 5px 10px; margin-top: 10px; font-size: 0.9rem;">了解更多</button>
            </div>
            <div class="knowledge-card">
                <i class="fas fa-user-friends"></i>
                <h5 id="f4-card2-title">代表人物</h5>
                <p id="f4-card2-desc">了解历代白局传承人及其艺术成就</p>
                <button id="f4-card2-btn" class="btn" style="padding: 5px 10px; margin-top: 10px; font-size: 0.9rem;">了解更多</button>
            </div>
            <div class="knowledge-card">
                <i class="fas fa-drum"></i>
                <h5 id="f4-card3-title">乐器介绍</h5>
                <p id="f4-card3-desc">认识白局表演中使用的传统乐器</p>
                <button id="f4-card3-btn" class="btn" style="padding: 5px 10px; margin-top: 10px; font-size: 0.9rem;">了解更多</button>
            </div>
            <div class="knowledge-card">
                <i class="fas fa-tshirt"></i>
                <h5 id="f4-card4-title">服饰文化</h5>
                <p id="f4-card4-desc">了解白局表演的传统服饰与装扮</p>
                <button id="f4-card4-btn" class="btn" style="padding: 5px 10px; margin-top: 10px; font-size: 0.9rem;">了解更多</button>
            </div>
        </div>
        
        <div style="margin: 20px 0;">
            <h4 id="f4-lang-title">语言切换</h4>
            <div class="language-selector">
                <div class="lang-option active" id="f4-lang-zh">中文</div>
                <div class="lang-option" id="f4-lang-en">English</div>
                <div class="lang-option" id="f4-lang-es">Español</div>
                <div class="lang-option" id="f4-lang-fr">Français</div>
                <div class="lang-option" id="f4-lang-ja">日本語</div>
                <div class="lang-option" id="f4-lang-ar">العربية</div>
            </div>
        </div>
    </div>

    <!-- 功能五：AI创作与分享中心 -->
    <div id="feature5-detail" class="feature-detail">
        <button class="close-btn" onclick="closeFeatureDetail('feature5')">&times;</button>
        <h3 id="f5-title">AI创作与分享中心</h3>
        <p id="f5-desc">输入主题词，AI将自动生成新的白局唱词与旋律，支持多语言输出。</p>
        
        <div class="ai-creation">
            <h4 id="f5-input-title">输入创作主题</h4>
            <input id="f5-input" type="text" class="theme-input" placeholder="例如：南京美食、龙舟节、金陵秋色...">
            
            <h4 id="f5-select-lang-title">选择输出语言</h4>
            <div class="language-selector">
                <div class="lang-option active">中文</div>
                <div class="lang-option">English</div>
                <div class="lang-option">Español</div>
                <div class="lang-option">Français</div>
                <div class="lang-option">日本語</div>
                <div class="lang-option">العربية</div>
            </div>
            
            <button id="f5-generate-btn" class="btn" style="width: 100%; margin: 15px 0;">生成白局作品</button>
            
            <div class="creation-result">
                <h4 id="f5-output-title">创作结果</h4>
                <p id="creation-text">输入主题后，AI将在这里生成白局唱词...</p>
            </div>
            
            <button id="f5-preview-btn" class="btn" style="width: 100%;">试听作品</button>
            <button id="f5-share-btn" class="btn" style="width: 100%; margin-top: 10px; background: var(--accent);">分享到社交平台</button>
        </div>
    </div>
<!-- 在功能详情弹窗部分添加 -->
<!-- 功能六：意见与反馈 -->
<div id="feature6-detail" class="feature-detail">
    <button class="close-btn" onclick="closeFeatureDetail('feature6')">&times;</button>
    <h3 id="f6-title" data-simple="意见反馈">意见与反馈</h3>
    <p id="f6-desc" data-simple="欢迎提出建议">您的宝贵意见将帮助我们不断改进平台，为您提供更好的服务体验。</p>
    
    <div class="feedback-interface">
        <div class="feedback-form">
            <div class="form-group">
                <label id="f6-type-label" for="feedback-type">反馈类型</label>
                <select id="feedback-type" class="form-select">
                    <option id="f6-type-suggestion" value="suggestion">功能建议</option>
                    <option id="f6-type-bug" value="bug">问题反馈</option>
                    <option id="f6-type-content" value="content">内容建议</option>
                    <option id="f6-type-other" value="other">其他</option>
                </select>
            </div>
            
            <div class="form-group">
                <label id="f6-title-label" for="feedback-title">标题</label>
                <input type="text" id="feedback-title" class="form-input" placeholder="请简要描述您的反馈">
            </div>
            
            <div class="form-group">
                <label id="f6-content-label" for="feedback-content">详细内容</label>
                <textarea id="feedback-content" class="form-textarea" placeholder="请详细描述您的建议或遇到的问题..." rows="6"></textarea>
            </div>
            
            <div class="form-group">
                <label id="f6-contact-label" for="contact-info">联系方式（选填）</label>
                <input type="text" id="contact-info" class="form-input" placeholder="邮箱或电话，方便我们回复您">
            </div>
            
            <div class="form-group">
                <label id="f6-rating-label">满意度评分</label>
                <div class="rating-stars">
                    <span class="star" data-rating="1">★</span>
                    <span class="star" data-rating="2">★</span>
                    <span class="star" data-rating="3">★</span>
                    <span class="star" data-rating="4">★</span>
                    <span class="star" data-rating="5">★</span>
                </div>
                <div class="rating-text" id="rating-text">请选择评分</div>
            </div>
            
            <button id="f6-submit-btn" class="btn" style="width: 100%;" onclick="submitFeedback()">提交反馈</button>
        </div>
        
        <div class="feedback-history" style="margin-top: 30px; display: none;" id="feedback-history">
            <h4 id="f6-history-title">反馈记录</h4>
            <div id="feedback-list" class="feedback-list">
                <!-- 反馈记录将在这里显示 -->
            </div>
        </div>
    </div>
</div>

<!-- 功能七：社会治理数据大屏 -->
<div id="feature7-detail" class="feature-detail">
    <button class="close-btn" onclick="closeFeatureDetail('feature7')">&times;</button>
    <h3 id="f7-title" data-simple="社会治理数据大屏">社会治理数据大屏</h3>
    <p id="f7-desc" data-simple="查看文化治理成效">实时展示文化传承参与度、治理成效与社会影响数据</p>
    
    <div class="governance-dashboard">
        <!-- 核心指标卡片 -->
        <div class="dashboard-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 10px;"></i>
                <div class="stat-value" id="total-users">12,458</div>
                <div class="stat-label">累计参与人数</div>
                <div class="stat-change" style="font-size: 0.9rem; margin-top: 5px;">↑ 15.3%</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                <i class="fas fa-graduation-cap" style="font-size: 2rem; margin-bottom: 10px;"></i>
                <div class="stat-value" id="training-hours">8,642</div>
                <div class="stat-label">累计学习时长(小时)</div>
                <div class="stat-change" style="font-size: 0.9rem; margin-top: 5px;">↑ 22.1%</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                <i class="fas fa-heart" style="font-size: 2rem; margin-bottom: 10px;"></i>
                <div class="stat-value" id="volunteers">356</div>
                <div class="stat-label">注册志愿者</div>
                <div class="stat-change" style="font-size: 0.9rem; margin-top: 5px;">↑ 8.7%</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 15px; text-align: center;">
                <i class="fas fa-star" style="font-size: 2rem; margin-bottom: 10px;"></i>
                <div class="stat-value" id="satisfaction">4.8</div>
                <div class="stat-label">用户满意度(5分制)</div>
                <div class="stat-change" style="font-size: 0.9rem; margin-top: 5px;">↑ 0.2</div>
            </div>
        </div>
        
        <!-- 参与度趋势图 -->
        <div class="chart-section" style="background: white; padding: 20px; border-radius: 15px; margin: 20px 0;">
            <h4 style="margin-bottom: 15px; color: var(--dark);">
                <i class="fas fa-chart-line"></i> 文化传承参与度趋势
            </h4>
            <div id="participation-chart" style="height: 300px; position: relative; background: #f8f9fa; border-radius: 10px; padding: 20px;">
                <canvas id="participation-canvas" style="width: 100%; height: 100%;"></canvas>
            </div>
        </div>
        
        <!-- 区域分布 -->
        <div class="chart-section" style="background: white; padding: 20px; border-radius: 15px; margin: 20px 0;">
            <h4 style="margin-bottom: 15px; color: var(--dark);">
                <i class="fas fa-map-marked-alt"></i> 参与用户区域分布
            </h4>
            <div class="region-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                <div class="region-item" style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">32.5%</div>
                    <div style="color: var(--text-light); margin-top: 5px;">南京市</div>
                </div>
                <div class="region-item" style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">18.3%</div>
                    <div style="color: var(--text-light); margin-top: 5px;">苏州市</div>
                </div>
                <div class="region-item" style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">15.7%</div>
                    <div style="color: var(--text-light); margin-top: 5px;">扬州市</div>
                </div>
                <div class="region-item" style="padding: 15px; background: #f8f9fa; border-radius: 10px; text-align: center;">
                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">33.5%</div>
                    <div style="color: var(--text-light); margin-top: 5px;">其他地区</div>
                </div>
            </div>
        </div>
        
        <!-- 功能使用统计 -->
        <div class="chart-section" style="background: white; padding: 20px; border-radius: 15px; margin: 20px 0;">
            <h4 style="margin-bottom: 15px; color: var(--dark);">
                <i class="fas fa-chart-pie"></i> 功能使用统计
            </h4>
            <div class="feature-usage" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div class="usage-item" style="padding: 15px; border-left: 4px solid var(--primary); background: #f8f9fa; border-radius: 5px;">
                    <div style="font-weight: bold; margin-bottom: 5px;">虚拟传承人演唱</div>
                    <div style="color: var(--text-light); font-size: 0.9rem;">使用次数: 8,234</div>
                    <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; margin-top: 10px;">
                        <div style="width: 85%; height: 100%; background: var(--primary); border-radius: 4px;"></div>
                    </div>
                </div>
                <div class="usage-item" style="padding: 15px; border-left: 4px solid var(--secondary); background: #f8f9fa; border-radius: 5px;">
                    <div style="font-weight: bold; margin-bottom: 5px;">AI语音跟唱训练</div>
                    <div style="color: var(--text-light); font-size: 0.9rem;">使用次数: 6,521</div>
                    <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; margin-top: 10px;">
                        <div style="width: 68%; height: 100%; background: var(--secondary); border-radius: 4px;"></div>
                    </div>
                </div>
                <div class="usage-item" style="padding: 15px; border-left: 4px solid var(--accent); background: #f8f9fa; border-radius: 5px;">
                    <div style="font-weight: bold; margin-bottom: 5px;">虚拟课堂教学</div>
                    <div style="color: var(--text-light); font-size: 0.9rem;">使用次数: 5,892</div>
                    <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; margin-top: 10px;">
                        <div style="width: 61%; height: 100%; background: var(--accent); border-radius: 4px;"></div>
                    </div>
                </div>
                <div class="usage-item" style="padding: 15px; border-left: 4px solid var(--success); background: #f8f9fa; border-radius: 5px;">
                    <div style="font-weight: bold; margin-bottom: 5px;">知识库与展厅</div>
                    <div style="color: var(--text-light); font-size: 0.9rem;">使用次数: 9,156</div>
                    <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; margin-top: 10px;">
                        <div style="width: 95%; height: 100%; background: var(--success); border-radius: 4px;"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 治理成效评估 -->
        <div class="chart-section" style="background: white; padding: 20px; border-radius: 15px; margin: 20px 0;">
            <h4 style="margin-bottom: 15px; color: var(--dark);">
                <i class="fas fa-trophy"></i> 文化治理成效评估
            </h4>
            <div class="effectiveness-metrics" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                <div class="metric-card" style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 15px;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 10px;">92%</div>
                    <div style="font-size: 1.1rem; margin-bottom: 5px;">文化传承覆盖率</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">覆盖全省13个地级市</div>
                </div>
                <div class="metric-card" style="padding: 20px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border-radius: 15px;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 10px;">156</div>
                    <div style="font-size: 1.1rem; margin-bottom: 5px;">社区文化活动</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">本年度已举办</div>
                </div>
                <div class="metric-card" style="padding: 20px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; border-radius: 15px;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 10px;">89%</div>
                    <div style="font-size: 1.1rem; margin-bottom: 5px;">公众满意度</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">基于用户反馈统计</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 功能八：公众参与与协同治理 -->
<div id="feature8-detail" class="feature-detail">
    <button class="close-btn" onclick="closeFeatureDetail('feature8')">&times;</button>
    <h3 id="f8-title" data-simple="公众参与中心">公众参与与协同治理</h3>
    <p id="f8-desc" data-simple="参与文化治理">志愿者招募、社区活动、协同治理决策参与</p>
    
    <div class="participation-center">
        <!-- 标签页导航 -->
        <div class="tab-navigation" style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #e0e0e0;">
            <button class="tab-btn active" onclick="switchTab('volunteer')" style="padding: 10px 20px; border: none; background: none; cursor: pointer; border-bottom: 2px solid var(--primary); color: var(--primary); font-weight: bold;">
                <i class="fas fa-hand-holding-heart"></i> 志愿者招募
            </button>
            <button class="tab-btn" onclick="switchTab('activity')" style="padding: 10px 20px; border: none; background: none; cursor: pointer; color: var(--text-light);">
                <i class="fas fa-calendar-alt"></i> 社区活动
            </button>
            <button class="tab-btn" onclick="switchTab('decision')" style="padding: 10px 20px; border: none; background: none; cursor: pointer; color: var(--text-light);">
                <i class="fas fa-vote-yea"></i> 决策参与
            </button>
        </div>
        
        <!-- 志愿者招募标签页 -->
        <div id="volunteer-tab" class="tab-content">
            <div style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                <h4 style="margin-bottom: 15px; color: var(--dark);">
                    <i class="fas fa-info-circle"></i> 志愿者招募说明
                </h4>
                <p style="color: var(--text-light); line-height: 1.8;">
                    我们正在招募热爱传统文化的志愿者，共同参与非遗文化的传承与推广工作。
                    志愿者将有机会参与线下活动组织、文化宣传、教学辅助等工作，为文化传承贡献自己的力量。
                </p>
            </div>
            
            <div class="volunteer-form" style="background: white; padding: 20px; border-radius: 15px;">
                <h4 style="margin-bottom: 20px; color: var(--dark);">志愿者报名表</h4>
                <div class="form-group">
                    <label for="volunteer-name">姓名</label>
                    <input type="text" id="volunteer-name" class="form-input" placeholder="请输入您的姓名">
                </div>
                <div class="form-group">
                    <label for="volunteer-phone">联系电话</label>
                    <input type="tel" id="volunteer-phone" class="form-input" placeholder="请输入您的联系电话">
                </div>
                <div class="form-group">
                    <label for="volunteer-email">邮箱</label>
                    <input type="email" id="volunteer-email" class="form-input" placeholder="请输入您的邮箱">
                </div>
                <div class="form-group">
                    <label for="volunteer-interest">感兴趣的方向</label>
                    <select id="volunteer-interest" class="form-select">
                        <option value="">请选择</option>
                        <option value="teaching">教学辅助</option>
                        <option value="activity">活动组织</option>
                        <option value="promotion">文化宣传</option>
                        <option value="research">文化研究</option>
                        <option value="other">其他</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="volunteer-experience">相关经验</label>
                    <textarea id="volunteer-experience" class="form-textarea" placeholder="请简要介绍您的相关经验或特长..." rows="4"></textarea>
                </div>
                <button class="btn" style="width: 100%;" onclick="submitVolunteer()">
                    <i class="fas fa-paper-plane"></i> 提交报名
                </button>
            </div>
            
            <div style="background: white; padding: 20px; border-radius: 15px; margin-top: 20px;">
                <h4 style="margin-bottom: 15px; color: var(--dark);">
                    <i class="fas fa-users"></i> 志愿者风采
                </h4>
                <div class="volunteer-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                    <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div style="font-size: 2rem; font-weight: bold; color: var(--primary);">356</div>
                        <div style="color: var(--text-light); margin-top: 5px;">注册志愿者</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div style="font-size: 2rem; font-weight: bold; color: var(--secondary);">1,248</div>
                        <div style="color: var(--text-light); margin-top: 5px;">服务总时长(小时)</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div style="font-size: 2rem; font-weight: bold; color: var(--accent);">89</div>
                        <div style="color: var(--text-light); margin-top: 5px;">活跃志愿者</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 社区活动标签页 -->
        <div id="activity-tab" class="tab-content" style="display: none;">
            <div style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                <h4 style="margin-bottom: 20px; color: var(--dark);">
                    <i class="fas fa-calendar-check"></i> 近期活动
                </h4>
                <div class="activity-list">
                    <div class="activity-item" style="padding: 15px; border-left: 4px solid var(--primary); background: #f8f9fa; border-radius: 5px; margin-bottom: 15px;">
                        <div style="font-weight: bold; margin-bottom: 5px; color: var(--dark);">白局文化进社区</div>
                        <div style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 10px;">
                            <i class="fas fa-calendar"></i> 2026年3月15日 14:00-16:00
                        </div>
                        <div style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 10px;">
                            <i class="fas fa-map-marker-alt"></i> 南京市秦淮区社区文化中心
                        </div>
                        <div style="color: var(--text); margin-bottom: 10px;">邀请白局传承人现场表演，与社区居民互动交流，传播传统文化。</div>
                        <button class="btn" style="padding: 5px 15px; font-size: 0.9rem;" onclick="joinActivity(1)">报名参加</button>
                    </div>
                    <div class="activity-item" style="padding: 15px; border-left: 4px solid var(--secondary); background: #f8f9fa; border-radius: 5px; margin-bottom: 15px;">
                        <div style="font-weight: bold; margin-bottom: 5px; color: var(--dark);">非遗文化体验日</div>
                        <div style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 10px;">
                            <i class="fas fa-calendar"></i> 2026年3月20日 10:00-17:00
                        </div>
                        <div style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 10px;">
                            <i class="fas fa-map-marker-alt"></i> 南京市博物馆
                        </div>
                        <div style="color: var(--text); margin-bottom: 10px;">展示多种非遗文化，包括白局、昆曲、评弹等，提供互动体验。</div>
                        <button class="btn" style="padding: 5px 15px; font-size: 0.9rem;" onclick="joinActivity(2)">报名参加</button>
                    </div>
                    <div class="activity-item" style="padding: 15px; border-left: 4px solid var(--accent); background: #f8f9fa; border-radius: 5px; margin-bottom: 15px;">
                        <div style="font-weight: bold; margin-bottom: 5px; color: var(--dark);">线上文化讲座</div>
                        <div style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 10px;">
                            <i class="fas fa-calendar"></i> 2026年3月25日 19:00-20:30
                        </div>
                        <div style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 10px;">
                            <i class="fas fa-video"></i> 线上直播
                        </div>
                        <div style="color: var(--text); margin-bottom: 10px;">邀请专家学者在线讲解非遗文化的历史与传承。</div>
                        <button class="btn" style="padding: 5px 15px; font-size: 0.9rem;" onclick="joinActivity(3)">报名参加</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 决策参与标签页 -->
        <div id="decision-tab" class="tab-content" style="display: none;">
            <div style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                <h4 style="margin-bottom: 15px; color: var(--dark);">
                    <i class="fas fa-comments"></i> 参与治理决策
                </h4>
                <p style="color: var(--text-light); line-height: 1.8; margin-bottom: 20px;">
                    我们重视公众意见，定期发布治理议题，邀请公众参与讨论和投票，共同决策文化传承的重要事项。
                </p>
            </div>
            
            <div class="decision-list">
                <div class="decision-item" style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                        <div>
                            <div style="font-weight: bold; font-size: 1.1rem; color: var(--dark); margin-bottom: 5px;">文化传承活动优先方向</div>
                            <div style="color: var(--text-light); font-size: 0.9rem;">
                                <i class="fas fa-clock"></i> 投票截止：2026年3月30日
                            </div>
                        </div>
                        <span style="padding: 5px 10px; background: var(--primary); color: white; border-radius: 5px; font-size: 0.8rem;">进行中</span>
                    </div>
                    <p style="color: var(--text); margin-bottom: 15px; line-height: 1.6;">
                        请选择您认为应该优先开展的文化传承活动方向，我们将根据投票结果调整活动计划。
                    </p>
                    <div class="vote-options" style="margin-bottom: 15px;">
                        <label style="display: block; padding: 10px; margin-bottom: 10px; background: #f8f9fa; border-radius: 5px; cursor: pointer;">
                            <input type="radio" name="decision1" value="school" style="margin-right: 10px;">
                            学校推广（进校园活动）
                        </label>
                        <label style="display: block; padding: 10px; margin-bottom: 10px; background: #f8f9fa; border-radius: 5px; cursor: pointer;">
                            <input type="radio" name="decision1" value="community" style="margin-right: 10px;">
                            社区普及（社区文化活动）
                        </label>
                        <label style="display: block; padding: 10px; margin-bottom: 10px; background: #f8f9fa; border-radius: 5px; cursor: pointer;">
                            <input type="radio" name="decision1" value="online" style="margin-right: 10px;">
                            线上推广（数字平台建设）
                        </label>
                        <label style="display: block; padding: 10px; margin-bottom: 10px; background: #f8f9fa; border-radius: 5px; cursor: pointer;">
                            <input type="radio" name="decision1" value="research" style="margin-right: 10px;">
                            学术研究（文化研究项目）
                        </label>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn" onclick="submitVote(1)" style="flex: 1;">提交投票</button>
                        <button class="btn" style="background: var(--text-light); flex: 1;">查看结果</button>
                    </div>
                </div>
                
                <div class="decision-item" style="background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                        <div>
                            <div style="font-weight: bold; font-size: 1.1rem; color: var(--dark); margin-bottom: 5px;">平台功能优化建议征集</div>
                            <div style="color: var(--text-light); font-size: 0.9rem;">
                                <i class="fas fa-clock"></i> 征集截止：2026年4月15日
                            </div>
                        </div>
                        <span style="padding: 5px 10px; background: var(--success); color: white; border-radius: 5px; font-size: 0.8rem;">进行中</span>
                    </div>
                    <p style="color: var(--text); margin-bottom: 15px; line-height: 1.6;">
                        我们正在收集用户对平台功能优化的建议，您的意见将直接影响平台的改进方向。
                    </p>
                    <textarea class="form-textarea" placeholder="请输入您的建议..." rows="4" style="width: 100%; margin-bottom: 15px;"></textarea>
                    <button class="btn" onclick="submitSuggestion()" style="width: 100%;">提交建议</button>
                </div>
            </div>
        </div>
    </div>
</div>
    <script>
        // 语言文本映射
        const languageTexts = {
            'zh-CN': {
                featureTitle: '江苏国家级戏曲类非遗数字平台',
                featureDescription: '探索南京白局非遗文化的数字化体验，感受传统与现代科技的完美融合',
                feature1Title: '虚拟传承人演唱展示',
                feature1Desc: '数字化还原的白局传承人虚拟形象，展示传统唱腔与表演',
                f1: {
                    title: '虚拟传承人演唱展示',
                    desc: '通过先进的虚拟人技术，我们数字化还原了白局传承人的形象、服饰和动作。虚拟传承人将为您演唱经典白局唱段，展示传统唱腔与表演技巧。',
                    choose: '选择唱段',
                    song1: '秦淮灯会',
                    song2: '金陵四季',
                    song3: '南京美食',
                    tagClassic: '传统经典',
                    tagModern: '现代创作',
                    btnPlayPrefix: '播放《',
                    btnPlaySuffix: '》',
                    btnStop: '停止播放',
                    statusPlaying: '正在播放: ',
                    statusStopped: '播放已停止',
                    statusSelected: '已选择: ',
                    statusHint: '，点击播放按钮开始表演',
                    performanceEnded: '表演结束'
                },
                feature2Title: 'AI语音跟唱训练',
                feature2Desc: '实时分析音高、节奏、发音，提供专业跟唱指导',
                f2: {
                    title: 'AI语音跟唱训练',
                    desc: '通过AI技术分析您的跟唱表现，实时提供音高、节奏和发音的反馈，帮助您快速掌握白局唱腔技巧。',
                    choose: '选择唱段',
                    lyricsTitle: '歌词',
                    song1: '秦淮灯会',
                    song2: '金陵四季',
                    song3: '南京美食',
                    pitch: '音准评分',
                    rhythm: '节奏评分',
                    pronunciation: '发音评分',
                    start: '开始跟唱',
                    sampleLyrics: {
                        song1: ['秦淮河畔灯火明，','游人如织喜盈盈。','白局一曲传千古，','文化传承永不停。'],
                        song2: ['春到金陵花满枝，','夏日荷塘映日辉。','秋风送爽桂花香，','冬雪纷飞兆丰年。'],
                        song3: ['盐水鸭香飘十里，','鸭血粉丝暖人心。','金陵美味传千载，','市井烟火最动人。']
                    }
                },
                feature3Title: '虚拟课堂沉浸式教学',
                feature3Desc: '在虚拟场景中学习白局历史与唱腔技巧',
                f3: {
                    title: '虚拟课堂沉浸式教学',
                    desc: '在虚拟场景中学习白局历史与唱腔技巧，虚拟老师将为您讲解白局知识，并回答您的提问。',
                    sceneTitle: '秦淮河畔虚拟课堂',
                    sceneSub: '选择您想学习的课程内容',
                    coursesTitle: '课程选择',
                    course1Title: '白局历史',
                    course1Desc: '了解白局的起源与发展历程',
                    course2Title: '唱腔技巧',
                    course2Desc: '学习白局的独特唱腔与表演技巧',
                    course3Title: '乐器介绍',
                    course3Desc: '认识白局表演中使用的传统乐器',
                    qaTitle: '语音提问',
                    qaPlaceholder: '输入您的问题...',
                    qaBtn: '提问'
                },
                feature4Title: '白局知识库与文化展厅',
                feature4Desc: '了解白局起源、发展、代表人物等丰富文化知识',
                f4: {
                    title: '白局知识库与文化展厅',
                    desc: '了解白局起源、发展、代表人物等丰富文化知识，支持多语言展示。',
                    card1Title: '历史渊源',
                    card1Desc: '白局起源于明代，是南京地区的传统曲艺形式',
                    card2Title: '代表人物',
                    card2Desc: '了解历代白局传承人及其艺术成就',
                    card3Title: '乐器介绍',
                    card3Desc: '认识白局表演中使用的传统乐器',
                    card4Title: '服饰文化',
                    card4Desc: '了解白局表演的传统服饰与装扮',
                    more: '了解更多',
                    langTitle: '语言切换'
                },
                feature5Title: 'AI创作与分享中心',
                feature5Desc: 'AI自动生成白局唱词与旋律，一键分享至社交平台',
                f5: {
                    title: 'AI创作与分享中心',
                    desc: '输入主题词，AI将自动生成新的白局唱词与旋律，支持多语言输出。',
                    inputTitle: '输入创作主题',
                    inputPlaceholder: '例如：南京美食、龙舟节、金陵秋色...',
                    selectLangTitle: '选择输出语言',
                    generateBtn: '生成白局作品',
                    outputTitle: '创作结果',
                    previewBtn: '试听作品',
                    shareBtn: '分享到社交平台',
                    resultPlaceholder: '输入主题后，AI将在这里生成白局唱词...'
                },
                feature6Title: '意见与反馈',  
                feature6Desc: '提出宝贵建议，帮助我们改进平台体验',
                f6: {
                    title: '意见与反馈',
                    desc: '您的宝贵意见将帮助我们不断改进平台，为您提供更好的服务体验。',
                    typeLabel: '反馈类型',
                    typeSuggestion: '功能建议',
                    typeBug: '问题反馈',
                    typeContent: '内容建议',
                    typeOther: '其他',
                    titleLabel: '标题',
                    titlePlaceholder: '请简要描述您的反馈',
                    contentLabel: '详细内容',
                    contentPlaceholder: '请详细描述您的建议或遇到的问题...',
                    contactLabel: '联系方式（选填）',
                    contactPlaceholder: '邮箱或电话，方便我们回复您',
                    ratingLabel: '满意度评分',
                    ratingText: '请选择评分',
                    submitBtn: '提交反馈',
                    historyTitle: '反馈记录'
                },
                backBtn: '返回语言选择',
                helpBtn: '获取帮助',
                backToGenres: '返回曲种选择',
                genreBaseName: '白局',
                genreTitleTemplate: '南京{genre}非遗文化数字平台',
                genreSelection: {
                    title: '选择曲种',
                    description: '请选择白局、昆曲、苏州评弹或扬剧',
                    options: {
                        baiju: '白局',
                        kunqu: '昆曲',
                        pintang: '苏州评弹',
                        yangju: '扬剧'
                    },
                    backToLanguage: '返回语言选择'
                }
            },
            'en': {
                featureTitle: 'Nanjing Baiju Intangible Cultural Heritage Digital Platform',
                featureDescription: 'Explore the digital experience of Nanjing Baiju intangible cultural heritage, feel the perfect integration of tradition and modern technology',
                feature1Title: 'Virtual Inheritor Performance',
                feature1Desc: 'Digitally restored Baiju inheritor virtual image, showcasing traditional singing and performance',
                f1: {
                    title: 'Virtual Inheritor Performance',
                    desc: 'Using advanced virtual human technology, we digitally restore the image, costume and actions of Baiju inheritors. The virtual inheritor will perform classic Baiju sections to showcase traditional singing and performance skills.',
                    choose: 'Select Section',
                    song1: 'Qinhuai Lantern Festival',
                    song2: 'Four Seasons of Jinling',
                    song3: 'Nanjing Cuisine',
                    tagClassic: 'Classic',
                    tagModern: 'Modern',
                    btnPlayPrefix: 'Play "',
                    btnPlaySuffix: '"',
                    btnStop: 'Stop',
                    statusPlaying: 'Playing: ',
                    statusStopped: 'Playback stopped',
                    statusSelected: 'Selected: ',
                    statusHint: ', click Play to start',
                    performanceEnded: 'Performance ended'
                },
                feature2Title: 'AI Voice Sing-Along Training',
                feature2Desc: 'Real-time analysis of pitch, rhythm, and pronunciation, providing professional guidance',
                f2: {
                    title: 'AI Voice Sing-Along Training',
                    desc: 'Analyze your sing-along performance with AI and provide real-time feedback on pitch, rhythm and pronunciation to help you master Baiju singing techniques.',
                    choose: 'Select Section',
                    lyricsTitle: 'Lyrics',
                    song1: 'Qinhuai Lantern Festival',
                    song2: 'Four Seasons of Jinling',
                    song3: 'Nanjing Cuisine',
                    pitch: 'Pitch',
                    rhythm: 'Rhythm',
                    pronunciation: 'Pronunciation',
                    start: 'Start Singing',
                    sampleLyrics: {
                        song1: ['By Qinhuai River lights are bright,','Crowds of people feel delight.','A Baiju song through ages long,','Heritage keeps shining strong.'],
                        song2: ['Spring in Jinling blossoms high,','Summer lotus kisses sky.','Autumn breeze with osmanthus scent,','Winter snow a harvest sent.'],
                        song3: ['Salted duck with fragrant steam,','Duck blood vermicelli dream.','Flavors passed through history,','Street life sings its symphony.']
                    }
                },
                feature3Title: 'Virtual Classroom Immersive Teaching',
                feature3Desc: 'Learn Baiju history and singing techniques in virtual scenes',
                f3: {
                    title: 'Virtual Classroom Immersive Teaching',
                    desc: 'Learn Baiju history and singing techniques in virtual scenes. The virtual teacher explains and answers your questions.',
                    sceneTitle: 'Virtual Classroom by Qinhuai River',
                    sceneSub: 'Choose what you want to learn',
                    coursesTitle: 'Course Selection',
                    course1Title: 'Baiju History',
                    course1Desc: 'Learn the origin and development of Baiju',
                    course2Title: 'Singing Techniques',
                    course2Desc: 'Study unique Baiju singing and performance skills',
                    course3Title: 'Instruments',
                    course3Desc: 'Traditional instruments used in Baiju',
                    qaTitle: 'Voice Q&A',
                    qaPlaceholder: 'Enter your question...',
                    qaBtn: 'Ask'
                },
                feature4Title: 'Baiju Knowledge Base and Cultural Exhibition Hall',
                feature4Desc: 'Learn about the origin, development, and representatives of Baiju',
                f4: {
                    title: 'Baiju Knowledge Base and Cultural Exhibition Hall',
                    desc: 'Learn the origin, development and representatives of Baiju, with multilingual display.',
                    card1Title: 'Historical Origins',
                    card1Desc: 'Baiju originated in the Ming dynasty, a traditional art of Nanjing',
                    card2Title: 'Representative Figures',
                    card2Desc: 'Learn about Baiju inheritors and their achievements',
                    card3Title: 'Instruments',
                    card3Desc: 'Traditional instruments used in Baiju performances',
                    card4Title: 'Costume Culture',
                    card4Desc: 'Traditional costumes and dress of Baiju performance',
                    more: 'Learn More',
                    langTitle: 'Language Switch'
                },
                feature5Title: 'AI Creation and Sharing Center',
                feature5Desc: 'AI automatically generates Baiju lyrics and melodies, one-click sharing to social platforms',
                f5: {
                    title: 'AI Creation and Sharing Center',
                    desc: 'Enter a theme, AI generates Baiju lyrics and melodies with multilingual output.',
                    inputTitle: 'Enter Creation Theme',
                    inputPlaceholder: 'e.g., Nanjing Cuisine, Dragon Boat Festival, Jinling Autumn...',
                    selectLangTitle: 'Select Output Language',
                    generateBtn: 'Generate Baiju Work',
                    outputTitle: 'Creation Result',
                    previewBtn: 'Preview Audio',
                    shareBtn: 'Share to Social Platforms',
                    resultPlaceholder: 'After entering a theme, AI will generate lyrics here...'
                },
                feature6Title: 'Feedback',  
                feature6Desc: 'Provide valuable suggestions to help us improve' ,
                f6: {
                    title: 'Feedback',
                    desc: 'Your valuable feedback helps us improve the platform for you.',
                    typeLabel: 'Feedback Type',
                    typeSuggestion: 'Feature Suggestion',
                    typeBug: 'Bug Report',
                    typeContent: 'Content Suggestion',
                    typeOther: 'Other',
                    titleLabel: 'Title',
                    titlePlaceholder: 'Briefly describe your feedback',
                    contentLabel: 'Details',
                    contentPlaceholder: 'Describe your suggestion or issue in detail...',
                    contactLabel: 'Contact (optional)',
                    contactPlaceholder: 'Email or phone for reply',
                    ratingLabel: 'Satisfaction Rating',
                    ratingText: 'Please select rating',
                    submitBtn: 'Submit Feedback',
                    historyTitle: 'Feedback History'
                },
                backBtn: 'Back to Language Selection',
                helpBtn: 'Get Help',
                backToGenres: 'Back to Genre Selection',
                genreBaseName: 'Baiju',
                genreTitleTemplate: 'Nanjing {genre} Intangible Cultural Heritage Digital Platform',
                genreSelection: {
                    title: 'Choose a Genre',
                    description: 'Select Baiju, Kunqu Opera, Suzhou Pingtan or Yangju Opera',
                    options: {
                        baiju: 'Baiju',
                        kunqu: 'Kunqu Opera',
                        pintang: 'Suzhou Pingtan',
                        yangju: 'Yangju Opera'
                    },
                    backToLanguage: 'Back to Language Selection'
                }
            },
            'es': {
                featureTitle: 'Plataforma Digital del Patrimonio Cultural Inmaterial de Baiju de Nanjing',
                featureDescription: 'Explore la experiencia digital del patrimonio cultural inmaterial de Baiju de Nanjing, sienta la integración perfecta de la tradición y la tecnología moderna',
                feature1Title: 'Presentación de Interpretación del Heredero Virtual',
                feature1Desc: 'Imagen virtual del heredero de Baiju restaurado digitalmente, mostrando canto y actuación tradicionales',
                f1: {
                    title: 'Presentación del Heredero Virtual',
                    desc: 'Con tecnología avanzada de humanos virtuales, restauramos digitalmente la imagen, vestimenta y movimientos de los herederos de Baiju. El heredero virtual interpretará secciones clásicas para mostrar el canto y la actuación tradicionales.',
                    choose: 'Seleccionar sección',
                    song1: 'Festival de Linternas de Qinhuai',
                    song2: 'Cuatro Estaciones de Jinling',
                    song3: 'Gastronomía de Nankín',
                    tagClassic: 'Clásico',
                    tagModern: 'Moderno',
                    btnPlayPrefix: 'Reproducir "',
                    btnPlaySuffix: '"',
                    btnStop: 'Detener',
                    statusPlaying: 'Reproduciendo: ',
                    statusStopped: 'Reproducción detenida',
                    statusSelected: 'Seleccionado: ',
                    statusHint: ', haga clic en Reproducir para iniciar',
                    performanceEnded: 'Actuación finalizada'
                },
                feature2Title: 'Entrenamiento de Canto con IA',
                feature2Desc: 'Análisis en tiempo real del tono, ritmo y pronunciación, proporcionando orientación profesional',
                f2: {
                    title: 'Entrenamiento de Canto con IA',
                    desc: 'Analiza tu interpretación con IA y proporciona retroalimentación en tiempo real sobre tono, ritmo y pronunciación.',
                    choose: 'Seleccionar sección',
                    lyricsTitle: 'Letra',
                    song1: 'Festival de Linternas de Qinhuai',
                    song2: 'Cuatro Estaciones de Jinling',
                    song3: 'Gastronomía de Nankín',
                    pitch: 'Tono',
                    rhythm: 'Ritmo',
                    pronunciation: 'Pronunciación',
                    start: 'Comenzar a cantar',
                    sampleLyrics: {
                        song1: ['A orillas de Qinhuai luces van,','Multitudes felices pasarán.','Una canción de Baiju sin fin,','El patrimonio sigue en trajín.'],
                        song2: ['Primavera en Jinling floreció,','Verano el loto resplandeció.','Otoño trae perfume especial,','Invierno anuncia cosecha total.'],
                        song3: ['Pato salado aroma sutil,','Sopa de pato, calor gentil.','Sabores que el tiempo guardó,','Vida de calle los celebró.']
                    }
                },
                feature3Title: 'Enseñanza Inmersiva en Aula Virtual',
                feature3Desc: 'Aprenda la historia y las técnicas de canto de Baiju en escenas virtuales',
                f3: {
                    title: 'Enseñanza Inmersiva en Aula Virtual',
                    desc: 'Aprenda historia y técnicas de canto de Baiju en escenas virtuales. El profesor virtual explicará y responderá.',
                    sceneTitle: 'Aula virtual junto al Qinhuai',
                    sceneSub: 'Elige lo que deseas aprender',
                    coursesTitle: 'Selección de cursos',
                    course1Title: 'Historia del Baiju',
                    course1Desc: 'Conozca el origen y desarrollo del Baiju',
                    course2Title: 'Técnicas de canto',
                    course2Desc: 'Estudie las técnicas únicas de Baiju',
                    course3Title: 'Instrumentos',
                    course3Desc: 'Instrumentos tradicionales usados en Baiju',
                    qaTitle: 'Preguntas por voz',
                    qaPlaceholder: 'Escribe tu pregunta...',
                    qaBtn: 'Preguntar'
                },
                feature4Title: 'Base de Conocimiento de Baiju y Sala de Exposición Cultural',
                feature4Desc: 'Conozca el origen, desarrollo y representantes de Baiju',
                f4: {
                    title: 'Base de Conocimiento de Baiju y Sala de Exposición Cultural',
                    desc: 'Conozca el origen, desarrollo y representantes de Baiju, con visualización multilingüe.',
                    card1Title: 'Orígenes históricos',
                    card1Desc: 'Baiju se originó en la dinastía Ming, arte tradicional de Nankín',
                    card2Title: 'Figuras representativas',
                    card2Desc: 'Conozca a los herederos de Baiju y sus logros',
                    card3Title: 'Instrumentos',
                    card3Desc: 'Instrumentos tradicionales usados en actuaciones de Baiju',
                    card4Title: 'Cultura del vestuario',
                    card4Desc: 'Vestimenta tradicional en las actuaciones de Baiju',
                    more: 'Saber más',
                    langTitle: 'Cambio de idioma'
                },
                feature5Title: 'Centro de Creación y Compartición con IA',
                feature5Desc: 'La IA genera automáticamente letras y melodías de Baiju, compartiendo con un clic en plataformas sociales',
                f5: {
                    title: 'Centro de Creación y Compartición con IA',
                    desc: 'Ingrese un tema; la IA genera letras y melodías de Baiju con salida multilingüe.',
                    inputTitle: 'Ingresar tema de creación',
                    inputPlaceholder: 'p.ej., Gastronomía de Nankín, Festival de Botes Dragón...',
                    selectLangTitle: 'Seleccionar idioma de salida',
                    generateBtn: 'Generar obra de Baiju',
                    outputTitle: 'Resultado de la creación',
                    previewBtn: 'Previsualizar audio',
                    shareBtn: 'Compartir a redes sociales',
                    resultPlaceholder: 'Tras ingresar un tema, la IA generará letras aquí...'
                },
                feature6Title: 'Comentarios y Sugerencias',  
                feature6Desc: 'Presente sugerencias valiosas para mejorar la plataforma' ,
                f6: {
                    title: 'Comentarios y Sugerencias',
                    desc: 'Sus valiosos comentarios nos ayudan a mejorar la plataforma.',
                    typeLabel: 'Tipo de comentario',
                    typeSuggestion: 'Sugerencia de función',
                    typeBug: 'Informe de error',
                    typeContent: 'Sugerencia de contenido',
                    typeOther: 'Otro',
                    titleLabel: 'Título',
                    titlePlaceholder: 'Describa brevemente su comentario',
                    contentLabel: 'Contenido',
                    contentPlaceholder: 'Describa su sugerencia o problema en detalle...',
                    contactLabel: 'Contacto (opcional)',
                    contactPlaceholder: 'Correo o teléfono para respuesta',
                    ratingLabel: 'Calificación de satisfacción',
                    ratingText: 'Seleccione una calificación',
                    submitBtn: 'Enviar comentario',
                    historyTitle: 'Historial de comentarios'
                },
                backBtn: 'Volver a la Selección de Idioma',
                helpBtn: 'Obtener Ayuda',
                backToGenres: 'Volver a la selección de género',
                genreBaseName: 'Baiju',
                genreTitleTemplate: 'Plataforma Digital del Patrimonio Cultural Inmaterial de {genre} de Nankín',
                genreSelection: {
                    title: 'Elige un género',
                    description: 'Selecciona Baiju, Ópera Kunqu, Pingtan de Suzhou o Ópera Yangju',
                    options: {
                        baiju: 'Baiju',
                        kunqu: 'Ópera Kunqu',
                        pintang: 'Pingtan de Suzhou',
                        yangju: 'Ópera Yangju'
                    },
                    backToLanguage: 'Volver a la selección de idioma'
                }
            },
            'fr': {
                featureTitle: 'Plateforme Numérique du Patrimoine Culturel Immatériel de Baiju de Nanjing',
                featureDescription: 'Explorez l\'expérience numérique du patrimoine culturel immatériel de Baiju de Nanjing, ressentez l\'intégration parfaite de la tradition et de la technologie moderne',
                feature1Title: 'Présentation de Performance de l\'Héritier Virtuel',
                feature1Desc: 'Image virtuelle de l\'héritier de Baiju restaurée numériquement, présentant le chant et la performance traditionnels',
                f1: {
                    title: 'Performance de l\'Héritier Virtuel',
                    desc: 'Grâce à la technologie des humains virtuels, nous restaurons numériquement l\'image, les costumes et les gestes des héritiers du Baiju. L\'héritier virtuel interprétera des sections classiques.',
                    choose: 'Choisir une section',
                    song1: 'Fête des Lanternes de Qinhuai',
                    song2: 'Quatre Saisons de Jinling',
                    song3: 'Cuisine de Nankin',
                    tagClassic: 'Classique',
                    tagModern: 'Moderne',
                    btnPlayPrefix: 'Lire "',
                    btnPlaySuffix: '"',
                    btnStop: 'Arrêter',
                    statusPlaying: 'Lecture: ',
                    statusStopped: 'Lecture arrêtée',
                    statusSelected: 'Sélectionné: ',
                    statusHint: ', cliquez sur Lire pour démarrer',
                    performanceEnded: 'Performance terminée'
                },
                feature2Title: 'Formation au Chant avec IA',
                feature2Desc: 'Analyse en temps réel de la hauteur, du rythme et de la prononciation, fournissant des conseils professionnels',
                f2: {
                    title: 'Formation au Chant avec IA',
                    desc: 'Analysez votre performance avec l\'IA et recevez des retours en temps réel sur la hauteur, le rythme et la prononciation.',
                    choose: 'Choisir une section',
                    lyricsTitle: 'Paroles',
                    song1: 'Fête des Lanternes de Qinhuai',
                    song2: 'Quatre Saisons de Jinling',
                    song3: 'Cuisine de Nankin',
                    pitch: 'Hauteur',
                    rhythm: 'Rythme',
                    pronunciation: 'Prononciation',
                    start: 'Commencer à chanter',
                    sampleLyrics: {
                        song1: ['Au bord Qinhuai, lueurs la nuit,','La foule passe, le coeur ébloui.','Un chant Baiju traverse le temps,','Le patrimoine vit vraiment.'],
                        song2: ['Printemps à Jinling, fleurs partout,','Été lotus brille beaucoup.','Automne parfume d\'osmanthe fin,','Hiver promet un bon destin.'],
                        song3: ['Canard salé au doux parfum,','Soupe de canard réchauffe chacun.','Saveurs de Nankin au fil des ans,','La rue chante ses accents.']
                    }
                },
                feature3Title: 'Enseignement Immersif en Classe Virtuelle',
                feature3Desc: 'Apprenez l\'histoire et les techniques de chant de Baiju dans des scènes virtuelles',
                f3: {
                    title: 'Enseignement Immersif en Classe Virtuelle',
                    desc: 'Apprenez l\'histoire et les techniques de chant du Baiju dans des scènes virtuelles. Le professeur virtuel explique et répond.',
                    sceneTitle: 'Classe virtuelle au bord du Qinhuai',
                    sceneSub: 'Choisissez ce que vous voulez apprendre',
                    coursesTitle: 'Sélection des cours',
                    course1Title: 'Histoire du Baiju',
                    course1Desc: 'Origine et développement du Baiju',
                    course2Title: 'Techniques de chant',
                    course2Desc: 'Techniques uniques de chant et performance',
                    course3Title: 'Instruments',
                    course3Desc: 'Instruments traditionnels utilisés au Baiju',
                    qaTitle: 'Questions vocales',
                    qaPlaceholder: 'Entrez votre question...',
                    qaBtn: 'Poser'
                },
                feature4Title: 'Base de Connaissances de Baiju et Hall d\'Exposition Culturelle',
                feature4Desc: 'Apprenez l\'origine, le développement et les représentants de Baiju',
                f4: {
                    title: 'Base de Connaissances de Baiju et Hall d\'Exposition Culturelle',
                    desc: 'Découvrez l\'origine, le développement et les représentants du Baiju, avec affichage multilingue.',
                    card1Title: 'Origines historiques',
                    card1Desc: 'Baiju vient de la dynastie Ming, art traditionnel de Nankin',
                    card2Title: 'Figures représentatives',
                    card2Desc: 'Héritiers du Baiju et leurs réalisations',
                    card3Title: 'Instruments',
                    card3Desc: 'Instruments traditionnels du Baiju',
                    card4Title: 'Culture vestimentaire',
                    card4Desc: 'Costumes traditionnels des performances de Baiju',
                    more: 'En savoir plus',
                    langTitle: 'Changement de langue'
                },
                feature5Title: 'Centre de Création et de Partage avec IA',
                feature5Desc: 'L\'IA génère automatiquement des paroles et des mélodies de Baiju, partage en un clic sur les plateformes sociales',
                f5: {
                    title: 'Centre de Création et de Partage avec IA',
                    desc: 'Saisissez un thème, l’IA génère des paroles et des mélodies de Baiju en plusieurs langues.',
                    inputTitle: 'Saisir le thème de création',
                    inputPlaceholder: 'ex. Cuisine de Nankin, Fête des bateaux-dragons...',
                    selectLangTitle: 'Choisir la langue de sortie',
                    generateBtn: 'Générer une œuvre de Baiju',
                    outputTitle: 'Résultat de la création',
                    previewBtn: 'Préécouter l’œuvre',
                    shareBtn: 'Partager sur les réseaux sociaux',
                    resultPlaceholder: 'Après avoir saisi un thème, l’IA générera des paroles ici...'
                },
                feature6Title: 'Commentaires et Suggestions',  
                feature6Desc: 'Faites des suggestions précieuses pour améliorer l\'expérience' , 
                f6: {
                    title: 'Commentaires et Suggestions',
                    desc: 'Vos retours nous aident à améliorer la plateforme.',
                    typeLabel: 'Type de commentaire',
                    typeSuggestion: 'Suggestion de fonctionnalité',
                    typeBug: 'Rapport de bug',
                    typeContent: 'Suggestion de contenu',
                    typeOther: 'Autre',
                    titleLabel: 'Titre',
                    titlePlaceholder: 'Décrivez brièvement votre retour',
                    contentLabel: 'Détails',
                    contentPlaceholder: 'Décrivez en détail votre suggestion ou problème...',
                    contactLabel: 'Contact (optionnel)',
                    contactPlaceholder: 'Email ou téléphone pour réponse',
                    ratingLabel: 'Évaluation de satisfaction',
                    ratingText: 'Veuillez sélectionner une note',
                    submitBtn: 'Envoyer',
                    historyTitle: 'Historique des commentaires'
                },
                backBtn: 'Retour à la Sélection de la Langue',
                helpBtn: 'Obtenir de l\'Aide',
                backToGenres: 'Retour à la sélection de genre',
                genreBaseName: 'Baiju',
                genreTitleTemplate: 'Plateforme Numérique du Patrimoine Culturel Immatériel de {genre} de Nanjing',
                genreSelection: {
                    title: 'Choisissez un genre',
                    description: 'Sélectionnez Baiju, Opéra Kunqu, Pingtan de Suzhou ou Opéra Yangju',
                    options: {
                        baiju: 'Baiju',
                        kunqu: 'Opéra Kunqu',
                        pintang: 'Pingtan de Suzhou',
                        yangju: 'Opéra Yangju'
                    },
                    backToLanguage: 'Retour à la sélection de la langue'
                }
            },
            'ja': {
                featureTitle: '南京白局無形文化遺産デジタルプラットフォーム',
                featureDescription: '南京白局無形文化遺産のデジタル体験を探索し、伝統と現代技術の完璧な融合を感じてください',
                feature1Title: '仮想継承者演唱展示',
                feature1Desc: 'デジタル復元された白局継承者の仮想イメージ、伝統的な唱腔とパフォーマンスを展示',
                f1: {
                    title: '仮想継承者演唱展示',
                    desc: '先進的なバーチャル技術で継承者の姿・衣装・動作を再現。古典的な唱段を披露します。',
                    choose: '唱段を選択',
                    song1: '秦淮灯会',
                    song2: '金陵四季',
                    song3: '南京グルメ',
                    tagClassic: 'クラシック',
                    tagModern: 'モダン',
                    btnPlayPrefix: '再生「',
                    btnPlaySuffix: '」',
                    btnStop: '停止',
                    statusPlaying: '再生中: ',
                    statusStopped: '再生停止',
                    statusSelected: '選択済み: ',
                    statusHint: '、再生をクリックしてください',
                    performanceEnded: '公演終了'
                },
                feature2Title: 'AI音声付き歌唱トレーニング',
                feature2Desc: '音高、リズム、発音をリアルタイム分析し、専門的な歌唱指導を提供',
                f2: {
                    title: 'AI音声付き歌唱トレーニング',
                    desc: 'AIで歌唱を分析し、音高・リズム・発音をリアルタイムでフィードバックします。',
                    choose: '唱段を選択',
                    lyricsTitle: '歌詞',
                    song1: '秦淮灯会',
                    song2: '金陵四季',
                    song3: '南京グルメ',
                    pitch: 'ピッチ',
                    rhythm: 'リズム',
                    pronunciation: '発音',
                    start: '歌唱開始',
                    sampleLyrics: {
                        song1: ['秦淮川に灯りともり、','人波賑わい喜び満ち。','白局の歌は千古の伝、','文化の継承止まず続く。'],
                        song2: ['春の金陵花満ちて、','夏は蓮池陽に輝く。','秋風清し桂花香り、','冬雪舞いて豊年告ぐ。'],
                        song3: ['塩水鴨の香り広がり、','鴨血春雨心を温める。','金陵の味わい受け継ぎ、','街の息遣い歌になる。']
                    }
                },
                feature3Title: '仮想教室没入型教育',
                feature3Desc: '仮想シーンで白局の歴史と歌唱技巧を学ぶ',
                f3: {
                    title: '仮想教室没入型教育',
                    desc: '仮想シーンで白局の歴史と歌唱技巧を学び、バーチャル先生が解説・回答します。',
                    sceneTitle: '秦淮川バーチャル教室',
                    sceneSub: '学びたい内容を選んでください',
                    coursesTitle: 'コース選択',
                    course1Title: '白局の歴史',
                    course1Desc: '白局の起源と発展を学ぶ',
                    course2Title: '歌唱テクニック',
                    course2Desc: '白局特有の唱法と演技を学ぶ',
                    course3Title: '楽器紹介',
                    course3Desc: '白局で使用される伝統楽器',
                    qaTitle: '音声質問',
                    qaPlaceholder: '質問を入力してください...',
                    qaBtn: '質問する'
                },
                feature4Title: '白局知識庫と文化展示ホール',
                feature4Desc: '白局の起源、発展、代表者などの豊富な文化知識を学ぶ',
                f4: {
                    title: '白局知識庫と文化展示ホール',
                    desc: '白局の起源・発展・代表人物などを多言語で紹介します。',
                    card1Title: '歴史的源流',
                    card1Desc: '白局は明代に起源を持つ南京の伝統芸能',
                    card2Title: '代表人物',
                    card2Desc: '歴代の継承者とその業績',
                    card3Title: '楽器紹介',
                    card3Desc: '白局の演奏に用いられる伝統楽器',
                    card4Title: '衣装文化',
                    card4Desc: '白局の伝統衣装と装い',
                    more: '詳しく見る',
                    langTitle: '言語切替'
                },
                feature5Title: 'AI創作と共有センター',
                feature5Desc: 'AIが自動的に白局の歌詞とメロディを生成し、ソーシャルプラットフォームにワンクリックで共有',
                f5: {
                    title: 'AI創作と共有センター',
                    desc: 'テーマを入力すると、AIが白局の歌詞と旋律を生成し、多言語で出力します。',
                    inputTitle: '創作テーマを入力',
                    inputPlaceholder: '例：南京グルメ、ドラゴンボート祭、金陵の秋...',
                    selectLangTitle: '出力言語を選択',
                    generateBtn: '白局作品を生成',
                    outputTitle: '創作結果',
                    previewBtn: '試聴する',
                    shareBtn: 'SNSに共有',
                    resultPlaceholder: 'テーマ入力後、ここに歌詞が生成されます...'
                },
                feature6Title: '意見とフィードバック',  
                feature6Desc: '貴重なご意見を提出し、プラットフォームを改善するのに役立てます' ,
                f6: {
                    title: '意見とフィードバック',
                    desc: '貴重なご意見は、プラットフォーム改善に役立ちます。',
                    typeLabel: 'フィードバック種類',
                    typeSuggestion: '機能提案',
                    typeBug: '不具合報告',
                    typeContent: '内容提案',
                    typeOther: 'その他',
                    titleLabel: 'タイトル',
                    titlePlaceholder: 'フィードバックの概要を入力',
                    contentLabel: '詳細',
                    contentPlaceholder: '提案や問題を詳しくご記入ください...',
                    contactLabel: '連絡先（任意）',
                    contactPlaceholder: '返信用メールまたは電話',
                    ratingLabel: '満足度評価',
                    ratingText: '評価を選択してください',
                    submitBtn: '送信',
                    historyTitle: 'フィードバック履歴'
                },
                backBtn: '言語選択に戻る',
                helpBtn: 'ヘルプを取得',
                backToGenres: '曲種選択に戻る',
                genreBaseName: '白局',
                genreTitleTemplate: '南京{genre}無形文化遺産デジタルプラットフォーム',
                genreSelection: {
                    title: '曲種を選択',
                    description: '白局・昆曲・蘇州評弾・揚劇から選択してください',
                    options: {
                        baiju: '白局',
                        kunqu: '昆曲',
                        pintang: '蘇州評弾',
                        yangju: '揚劇'
                    },
                    backToLanguage: '言語選択に戻る'
                }
            },
            'ar': {
                featureTitle: 'منصة التراث الثقافي غير المادي لبايجو في نانجينغ الرقمية',
                featureDescription: 'استكشف التجربة الرقمية للتراث الثقافي غير المادي لبايجو في نانجينغ، وشعر بالتكامل المثالي بين التقاليد والتكنولوجيا الحديثة',
                feature1Title: 'عرض أداء الوريث الافتراضي',
                feature1Desc: 'صورة افتراضية لوريث بايجو المستعاد رقميًا، تعرض الغناء والأداء التقليدي',
                f1: {
                    title: 'عرض أداء الوريث الافتراضي',
                    desc: 'باستخدام تقنية الإنسان الافتراضي المتقدمة، نعيد تصوير صورة وملابس وحركات ورثة بايجو. سيؤدي الوريث الافتراضي مقاطع كلاسيكية.',
                    choose: 'اختر المقطع',
                    song1: 'مهرجان فوانيس تشينهواي',
                    song2: 'فصول جينلينغ الأربعة',
                    song3: 'مأكولات نانجينغ',
                    tagClassic: 'كلاسيكي',
                    tagModern: 'حديث',
                    btnPlayPrefix: 'تشغيل "',
                    btnPlaySuffix: '"',
                    btnStop: 'إيقاف',
                    statusPlaying: 'يشغّل: ',
                    statusStopped: 'تم الإيقاف',
                    statusSelected: 'تم الاختيار: ',
                    statusHint: '، انقر تشغيل للبدء',
                    performanceEnded: 'انتهى العرض'
                },
                feature2Title: 'تدريب الغناء بصوت الذكاء الاصطناعي',
                feature2Desc: 'تحليل في الوقت الحقيقي للنغمة والإيقاع والنطق، وتقديم إرشادات احترافية',
                f2: {
                    title: 'تدريب الغناء بالذكاء الاصطناعي',
                    desc: 'يحلّل الأداء ويقدّم ملاحظات فورية حول النغمة والإيقاع والنطق.',
                    choose: 'اختر المقطع',
                    lyricsTitle: 'الكلمات',
                    song1: 'مهرجان فوانيس تشينهواي',
                    song2: 'فصول جينلينغ الأربعة',
                    song3: 'مأكولات نانجينغ',
                    pitch: 'طبقة الصوت',
                    rhythm: 'الإيقاع',
                    pronunciation: 'النطق',
                    start: 'ابدأ الغناء',
                    sampleLyrics: {
                        song1: ['عند نهر تشينهواي الأنوار تضيء،','والناس فرِحون في المسير.','أغنية بايجو عبر العصور،','والإرث باقٍ لا يزول.'],
                        song2: ['ربيع جنلينغ زهور تعلو،','صيف اللوتس يلمع سطوعًا.','نسيم الخريف عطر أوسمانثوس،','ثلج الشتاء يبشّر بحصاد.'],
                        song3: ['بطة مالحة عطرها يسري،','حساء بطة يدفئ القلوب.','نكهات نانجينغ عبر السنين،','حياة الشارع تُنشِد الطيوب.']
                    }
                },
                feature3Title: 'التدريس التغميسي في الفصل الافتراضي',
                feature3Desc: 'تعلم تاريخ بايجو وتقنيات الغناء في مشاهد افتراضية',
                f3: {
                    title: 'التدريس التغميسي في الفصل الافتراضي',
                    desc: 'تعلم تاريخ بايجو وتقنيات الغناء في مشاهد افتراضية. يشرح المعلم الافتراضي ويجيب عن أسئلتك.',
                    sceneTitle: 'فصل افتراضي على ضفاف تشينهواي',
                    sceneSub: 'اختر ما تريد تعلمه',
                    coursesTitle: 'اختيار الدروس',
                    course1Title: 'تاريخ بايجو',
                    course1Desc: 'تعرف على أصل وتطور بايجو',
                    course2Title: 'تقنيات الغناء',
                    course2Desc: 'تقنيات الغناء والأداء الخاصة ببايجو',
                    course3Title: 'الآلات',
                    course3Desc: 'الآلات التقليدية المستخدمة في بايجو',
                    qaTitle: 'أسئلة صوتية',
                    qaPlaceholder: 'أدخل سؤالك...',
                    qaBtn: 'اسأل'
                },
                feature4Title: 'قاعدة معرفة بايجو وقاعة المعرض الثقافي',
                feature4Desc: 'تعرف على أصل وتطور وممثلي بايجو',
                f4: {
                    title: 'قاعدة معرفة بايجو وقاعة المعرض الثقافي',
                    desc: 'تعرف على أصل وتطور وممثلي بايجو مع عرض متعدد اللغات.',
                    card1Title: 'الأصول التاريخية',
                    card1Desc: 'نشأ بايجو في سلالة مينغ، فن تقليدي في نانجينغ',
                    card2Title: 'الشخصيات الممثلة',
                    card2Desc: 'تعرّف على ورثة بايجو وإنجازاتهم',
                    card3Title: 'الآلات',
                    card3Desc: 'الآلات التقليدية المستخدمة في عروض بايجو',
                    card4Title: 'ثقافة الأزياء',
                    card4Desc: 'الأزياء التقليدية في عروض بايجو',
                    more: 'المزيد',
                    langTitle: 'تبديل اللغة'
                },
                feature5Title: 'مركز الإبداع والمشاركة بالذكاء الاصطناعي',
                feature5Desc: 'الذكاء الاصطناعي يولد تلقائيًا كلمات وألحان بايجو، ومشاركة بنقرة واحدة إلى المنصات الاجتماعية',
                f5: {
                    title: 'مركز الإبداع والمشاركة بالذكاء الاصطناعي',
                    desc: 'أدخل موضوعًا؛ سيُنشئ الذكاء الاصطناعي كلمات وألحان بايجو مع مخرجات متعددة اللغات.',
                    inputTitle: 'أدخل موضوع الإبداع',
                    inputPlaceholder: 'مثل: مأكولات نانجينغ، مهرجان قوارب التنين...',
                    selectLangTitle: 'اختر لغة الإخراج',
                    generateBtn: 'إنشاء عمل بايجو',
                    outputTitle: 'نتيجة الإبداع',
                    previewBtn: 'استمع للعمل',
                    shareBtn: 'مشاركة على المنصات الاجتماعية',
                    resultPlaceholder: 'بعد إدخال الموضوع، سيولد الذكاء الاصطناعي كلمات هنا...'
                },
                feature6Title: 'الآراء والملاحظات',  
                feature6Desc: 'قدم اقتراحات قيمة للمساعدة في تحسين تجربة المنصة' ,
                f6: {
                    title: 'الآراء والملاحظات',
                    desc: 'ملاحظاتك القيّمة تساعدنا على تحسين المنصة.',
                    typeLabel: 'نوع الملاحظة',
                    typeSuggestion: 'اقتراح ميزة',
                    typeBug: 'تبليغ عن مشكلة',
                    typeContent: 'اقتراح محتوى',
                    typeOther: 'أخرى',
                    titleLabel: 'العنوان',
                    titlePlaceholder: 'صف بإيجاز ملاحظتك',
                    contentLabel: 'المحتوى',
                    contentPlaceholder: 'صف اقتراحك أو مشكلتك بالتفصيل...',
                    contactLabel: 'معلومات الاتصال (اختياري)',
                    contactPlaceholder: 'البريد الإلكتروني أو الهاتف للرد',
                    ratingLabel: 'تقييم الرضا',
                    ratingText: 'يرجى اختيار تقييم',
                    submitBtn: 'إرسال',
                    historyTitle: 'سجل الملاحظات'
                },
                backBtn: 'العودة إلى اختيار اللغة',
                helpBtn: 'الحصول على المساعدة',
                backToGenres: 'العودة إلى اختيار النوع',
                genreBaseName: 'بايجو',
                genreTitleTemplate: 'منصة نانجينغ الرقمية للتراث الثقافي غير المادي لـ{genre}',
                genreSelection: {
                    title: 'اختر نوع الفن',
                    description: 'اختر بايجو أو أوبرا كونتشو أو بينغتان سوتشو أو أوبرا يانغجو',
                    options: {
                        baiju: 'بايجو',
                        kunqu: 'أوبرا كونتشو',
                        pintang: 'بينغتان سوتشو',
                        yangju: 'أوبرا يانغجو'
                    },
                    backToLanguage: 'العودة إلى اختيار اللغة'
                }
            }
        };

        // 当前选择的语言
        let currentLanguage = 'zh-CN';
        // 当前选择的曲种（默认白局）
        let currentGenre = 'baiju';
        // 记录基线文本，用于不同曲种的动态替换（避免多次替换叠加）
        const originalTexts = {};
        const replaceTextIds = [
            'feature-title',
            'feature-description',
            'feature1-title',
            'feature1-desc',
            'feature2-title',
            'feature2-desc',
            'feature3-title',
            'feature3-desc',
            'feature4-title',
            'feature4-desc',
            'feature5-title',
            'feature5-desc',
            'feature6-title',
            'feature6-desc',
            'f1-title',
            'f1-desc',
            'f2-title',
            'f2-desc',
            'f3-title',
            'f3-desc',
            'f4-title',
            'f4-desc',
            'f5-title',
            'f5-desc',
            'f6-title',
            'f6-desc'
        ];
        const defaultGenreNames = {
            baiju: '白局',
            kunqu: '昆曲',
            pintang: '苏州评弹',
            yangju: '扬剧'
        };
        let currentBaseGenreName = defaultGenreNames.baiju;

        function getGenreDisplayName(genre, lang = currentLanguage) {
            const langConfig = languageTexts[lang];
            const nameFromConfig = langConfig?.genreSelection?.options?.[genre];
            if (nameFromConfig) {
                return nameFromConfig;
            }
            return defaultGenreNames[genre] || genre;
        }

        function getGenreTitle(lang, genre) {
            const langConfig = languageTexts[lang];
            const template = langConfig?.genreTitleTemplate;
            const displayName = getGenreDisplayName(genre, lang);
            
            // 只有白局显示"南京"前缀，其他剧种不显示
            if (genre === 'baiju') {
                if (template) {
                    return template.replace(/\{genre\}/g, displayName);
                }
                // 根据语言返回对应的标题
                const baijuTitles = {
                    'zh-CN': `南京${displayName}非遗文化数字平台`,
                    'en': `Nanjing ${displayName} Intangible Cultural Heritage Digital Platform`,
                    'es': `Plataforma Digital del Patrimonio Cultural Inmaterial de ${displayName} de Nankín`,
                    'fr': `Plateforme Numérique du Patrimoine Culturel Immatériel de ${displayName} de Nanjing`,
                    'ja': `南京${displayName}無形文化遺産デジタルプラットフォーム`,
                    'ar': `منصة نانجينغ الرقمية للتراث الثقافي غير المادي لـ${displayName}`
                };
                return baijuTitles[lang] || `${displayName}非遗文化数字平台`;
            } else {
                // 其他剧种：移除"南京"前缀
                if (template) {
                    let title = template.replace(/\{genre\}/g, displayName);
                    // 移除"南京"前缀（支持多种语言）
                    // 中文：南京
                    // 英文：Nanjing
                    // 西班牙文：Nankín, de Nankín
                    // 法文：de Nanjing
                    // 日文：南京
                    // 阿拉伯文：نانجينغ, نانجينغ الرقمية
                    title = title.replace(/南京/g, '')
                                 .replace(/Nanjing\s+/gi, '')
                                 .replace(/Nankín\s+/gi, '')
                                 .replace(/\s+de\s+Nankín/gi, '')
                                 .replace(/\s+de\s+Nanjing/gi, '')
                                 .replace(/نانجينغ\s+/gi, '')
                                 .replace(/\s+نانجينغ\s+الرقمية/gi, ' الرقمية');
                    // 清理多余的空格和标点
                    title = title.replace(/\s+/g, ' ').replace(/\s+,\s+/g, ',').trim();
                    return title;
                }
                // 根据语言返回对应的标题（无南京前缀）
                const otherTitles = {
                    'zh-CN': `${displayName}非遗文化数字平台`,
                    'en': `${displayName} Intangible Cultural Heritage Digital Platform`,
                    'es': `Plataforma Digital del Patrimonio Cultural Inmaterial de ${displayName}`,
                    'fr': `Plateforme Numérique du Patrimoine Culturel Immatériel de ${displayName}`,
                    'ja': `${displayName}無形文化遺産デジタルプラットフォーム`,
                    'ar': `منصة الرقمية للتراث الثقافي غير المادي لـ${displayName}`
                };
                return otherTitles[lang] || `${displayName}非遗文化数字平台`;
            }
        }

        function escapeRegExp(str) {
            return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        function updateGenrePageContent(lang) {
            const langConfig = languageTexts[lang];
            const genreContent = langConfig?.genreSelection;
            const titleEl = document.getElementById('genre-page-title');
            const descEl = document.getElementById('genre-page-desc');
            const backBtn = document.getElementById('genre-back-btn');
            if (titleEl) {
                titleEl.textContent = genreContent?.title || getGenreTitle(lang, 'baiju');
            }
            if (descEl) {
                descEl.textContent = genreContent?.description || '请选择曲种';
            }
            const optionIds = {
                baiju: 'genre-option-baiju',
                kunqu: 'genre-option-kunqu',
                pintang: 'genre-option-pintang',
                yangju: 'genre-option-yangju'
            };
            Object.entries(optionIds).forEach(([genreKey, elementId]) => {
                const el = document.getElementById(elementId);
                if (!el) return;
                el.textContent = getGenreDisplayName(genreKey, lang);
            });
            if (backBtn) {
                backBtn.textContent = genreContent?.backToLanguage || langConfig?.backBtn || '返回语言选择';
            }
        }

        const conversationConfigs = {
            'zh-CN': {
                title: '互动问答',
                userLabel: '访客',
                assistantLabel: '传承人',
                inputPlaceholder: '请输入您的问题或向我点唱...',
                sendButton: '发送',
                voiceButtonIdle: '语音提问',
                voiceButtonListening: '停止录音',
                autoDetectLabel: '自动识别语言',
                ttsLabel: '语音播报',
                detectedLanguageLabel: '识别语言：',
                noDetection: '待识别',
                welcome: '您好，我是白局数字传承人，很高兴与您交流。可以问我白局相关问题，或让我演唱经典唱段。',
                listening: '正在聆听，请开口说话……',
                recognitionUnsupported: '当前浏览器暂不支持语音识别，请使用最新版的 Chrome 或 Edge 浏览器。',
                thinking: '让我想一想……',
                ttsPlaying: '语音播报中…',
                ttsStopped: '语音播报已结束。',
                error: '抱歉，我暂时无法处理，请稍后再试。',
                noSpeech: '未检测到语音，请重试。',
                audioCapture: '无法访问麦克风，请检查权限设置。',
                networkError: '网络错误，请检查网络连接。',
                permissionDenied: '麦克风权限被拒绝，请在浏览器设置中允许访问麦克风。',
                serviceNotAllowed: '语音识别服务不可用，请稍后再试。',
                httpsRequired: '语音识别需要HTTPS连接，请使用安全连接访问。',
                languageNames: {
                    'zh-CN': '中文',
                    'en': '英语',
                    'es': '西班牙语',
                    'fr': '法语',
                    'ja': '日语',
                    'ar': '阿拉伯语'
                },
                responses: {
                    greeting: '您好！欢迎来到南京白局数字平台。',
                    intro: '白局是南京地区的传统曲艺，起源于明代，因演唱时穿着白色长衫而得名，唱词通俗、旋律清亮，是国家级非物质文化遗产。',
                    history: '白局由明清时期的说唱形式发展而来，融合了民间说唱、琴曲等元素，清末民初进入茶馆戏台，代表人物有朱自清、吴树德等传承人。',
                    instrument: '白局常用乐器有扬琴、琵琶、三弦、笛子等，演唱者还会以手拍节，形成“口唱手打”的特色表现。',
                    costume: '传统白局演员多穿白色长衫配腰带，女性还会搭配绣花披肩和头饰，以突出素雅端庄的舞台形象。',
                    default: '我可以为您介绍白局的历史、曲目、传承人，也可以为您演唱{song1}、{song2}等唱段，欢迎提问！',
                    singGeneric: '好的，我这就为您献上{song}，请您欣赏。',
                    singSong1: '好的，马上为您演唱{song}，再现秦淮灯火的风情。',
                    singSong2: '收到，让我们一起感受{song}中南京四季的光景。',
                    singSong3: '没问题，{song}将带您品味南京的风味故事。'
                }
            },
            'en': {
                title: 'Interactive Q&A',
                userLabel: 'Visitor',
                assistantLabel: 'Inheritor',
                inputPlaceholder: 'Ask a question or request a song...',
                sendButton: 'Send',
                voiceButtonIdle: 'Voice Question',
                voiceButtonListening: 'Stop Recording',
                autoDetectLabel: 'Auto language detection',
                ttsLabel: 'Voice reply',
                detectedLanguageLabel: 'Detected language:',
                noDetection: 'Pending',
                welcome: 'Hello, I am the digital inheritor of Baiju. Feel free to ask about Baiju or request a classic excerpt.',
                listening: 'Listening... please speak clearly.',
                recognitionUnsupported: 'Speech recognition is not supported in this browser. Please try the latest Chrome or Edge.',
                thinking: 'Let me think...',
                ttsPlaying: 'Playing voice reply...',
                ttsStopped: 'Voice reply stopped.',
                error: 'Sorry, I could not process that. Please try again.',
                noSpeech: 'No speech detected. Please try again.',
                audioCapture: 'Cannot access microphone. Please check permissions.',
                networkError: 'Network error. Please check your connection.',
                permissionDenied: 'Microphone permission denied. Please allow microphone access in browser settings.',
                serviceNotAllowed: 'Speech recognition service unavailable. Please try again later.',
                httpsRequired: 'Speech recognition requires HTTPS. Please use a secure connection.',
                languageNames: {
                    'zh-CN': 'Chinese',
                    'en': 'English',
                    'es': 'Spanish',
                    'fr': 'French',
                    'ja': 'Japanese',
                    'ar': 'Arabic'
                },
                responses: {
                    greeting: 'Hello! Welcome to the Nanjing Baiju digital platform.',
                    intro: 'Baiju is a traditional narrative singing art from Nanjing. It began in the Ming dynasty and was named after the white robes performers wore. The lyrics are vivid, the melodies bright, and it is listed as a National Intangible Cultural Heritage.',
                    history: 'Baiju evolved from storytelling arts in the Ming and Qing dynasties, blending folk ballads and instrumental styles. It flourished in teahouses during the late Qing and early Republic eras, with masters such as Zhu Ziqing and Wu Shude carrying it forward.',
                    instrument: 'Typical Baiju accompaniment includes yangqin, pipa, sanxian, and dizi. Performers also clap rhythm with their hands, creating the signature “singing with handmade percussion” style.',
                    costume: 'Traditional performers wear long white gowns with sashes, while female artists may add embroidered shawls and hair ornaments to highlight an elegant stage presence.',
                    default: 'I can introduce Baiju history, repertoire, and inheritors, or sing excerpts such as {song1} and {song2}. Feel free to ask!',
                    singGeneric: 'Sure, let me sing {song} for you.',
                    singSong1: 'With pleasure. Enjoy {song} and the festive glow of Qinhuai.',
                    singSong2: 'Certainly. Let\'s experience the four seasons of Nanjing in {song}.',
                    singSong3: 'Of course. {song} shares the flavorful stories of Nanjing.'
                }
            },
            'es': {
                title: 'Preguntas interactivas',
                userLabel: 'Visitante',
                assistantLabel: 'Heredero',
                inputPlaceholder: 'Haz una pregunta o pide una canción...',
                sendButton: 'Enviar',
                voiceButtonIdle: 'Pregunta por voz',
                voiceButtonListening: 'Detener grabación',
                autoDetectLabel: 'Detectar idioma automáticamente',
                ttsLabel: 'Respuesta por voz',
                detectedLanguageLabel: 'Idioma detectado:',
                noDetection: 'En espera',
                welcome: 'Hola, soy el heredero digital del Baiju. Puedes preguntarme sobre el Baiju o pedirme un fragmento clásico.',
                listening: 'Escuchando... por favor habla con claridad.',
                recognitionUnsupported: 'El reconocimiento de voz no está disponible en este navegador. Prueba con la última versión de Chrome o Edge.',
                thinking: 'Déjame pensar...',
                ttsPlaying: 'Reproduciendo respuesta de voz...',
                ttsStopped: 'Respuesta de voz detenida.',
                error: 'Lo siento, no pude procesarlo. Inténtalo de nuevo.',
                noSpeech: 'No se detectó voz. Por favor, inténtalo de nuevo.',
                audioCapture: 'No se puede acceder al micrófono. Por favor, verifica los permisos.',
                networkError: 'Error de red. Por favor, verifica tu conexión.',
                permissionDenied: 'Permiso de micrófono denegado. Por favor, permite el acceso al micrófono en la configuración del navegador.',
                serviceNotAllowed: 'El servicio de reconocimiento de voz no está disponible. Por favor, inténtalo más tarde.',
                httpsRequired: 'El reconocimiento de voz requiere HTTPS. Por favor, usa una conexión segura.',
                languageNames: {
                    'zh-CN': 'Chino',
                    'en': 'Inglés',
                    'es': 'Español',
                    'fr': 'Francés',
                    'ja': 'Japonés',
                    'ar': 'Árabe'
                },
                responses: {
                    greeting: '¡Hola! Bienvenido a la plataforma digital del Baiju de Nankín.',
                    intro: 'El Baiju es un arte tradicional de canto narrativo originario de Nankín. Surgió en la dinastía Ming y se nombra por las túnicas blancas que usaban los intérpretes. Las letras son populares, las melodías brillantes y está reconocido como Patrimonio Cultural Inmaterial nacional.',
                    history: 'El Baiju evolucionó a partir de formas narrativas de las épocas Ming y Qing, combinando baladas populares y estilos instrumentales. A finales de la dinastía Qing y comienzos de la República floreció en los salones de té, con maestros como Zhu Ziqing y Wu Shude como referentes.',
                    instrument: 'Los instrumentos habituales incluyen yangqin, pipa, sanxian y dizi. Los intérpretes también marcan el ritmo con las palmas, creando el estilo característico de “cantar y percutir con las manos”.',
                    costume: 'Los artistas tradicionales visten largas túnicas blancas con cinturón; las intérpretes suelen añadir chales bordados y adornos en el cabello para resaltar una presencia escénica elegante.',
                    default: 'Puedo contarte sobre la historia, el repertorio y los herederos del Baiju, o cantar fragmentos como {song1} y {song2}. ¡Pregúntame lo que quieras!',
                    singGeneric: 'Claro, cantaré {song} para ti.',
                    singSong1: 'Con gusto, disfruta {song} y el ambiente festivo del Qinhuai.',
                    singSong2: 'Perfecto, vivamos las cuatro estaciones de Nankín en {song}.',
                    singSong3: 'Por supuesto, {song} te llevará a saborear las historias gastronómicas de Nankín.'
                }
            },
            'fr': {
                title: 'Questions interactives',
                userLabel: 'Visiteur',
                assistantLabel: 'Héritier',
                inputPlaceholder: 'Posez une question ou demandez un air...',
                sendButton: 'Envoyer',
                voiceButtonIdle: 'Question vocale',
                voiceButtonListening: 'Arrêter l\'enregistrement',
                autoDetectLabel: 'Détection automatique de la langue',
                ttsLabel: 'Réponse vocale',
                detectedLanguageLabel: 'Langue détectée :',
                noDetection: 'En attente',
                welcome: 'Bonjour, je suis l\'héritier numérique du Baiju. N\'hésitez pas à me poser vos questions ou à me demander un extrait.',
                listening: 'À l\'écoute... veuillez parler clairement.',
                recognitionUnsupported: 'La reconnaissance vocale n\'est pas disponible sur ce navigateur. Essayez la dernière version de Chrome ou Edge.',
                thinking: 'Laissez-moi réfléchir...',
                ttsPlaying: 'Lecture de la réponse vocale...',
                ttsStopped: 'Réponse vocale terminée.',
                error: 'Désolé, je ne peux pas traiter votre demande pour le moment.',
                noSpeech: 'Aucune voix détectée. Veuillez réessayer.',
                audioCapture: 'Impossible d\'accéder au microphone. Veuillez vérifier les permissions.',
                networkError: 'Erreur réseau. Veuillez vérifier votre connexion.',
                permissionDenied: 'Permission du microphone refusée. Veuillez autoriser l\'accès au microphone dans les paramètres du navigateur.',
                serviceNotAllowed: 'Le service de reconnaissance vocale n\'est pas disponible. Veuillez réessayer plus tard.',
                httpsRequired: 'La reconnaissance vocale nécessite HTTPS. Veuillez utiliser une connexion sécurisée.',
                languageNames: {
                    'zh-CN': 'Chinois',
                    'en': 'Anglais',
                    'es': 'Espagnol',
                    'fr': 'Français',
                    'ja': 'Japonais',
                    'ar': 'Arabe'
                },
                responses: {
                    greeting: 'Bonjour ! Bienvenue sur la plateforme numérique du Baiju de Nankin.',
                    intro: 'Le Baiju est un art vocal narratif traditionnel de Nankin. Apparu sous la dynastie Ming, il doit son nom aux longues robes blanches des interprètes. Les paroles sont populaires, la mélodie claire, et il est inscrit au patrimoine culturel immatériel national.',
                    history: 'Le Baiju s\'est développé à partir des arts de récit des époques Ming-Qing, mêlant ballades populaires et accompagnements instrumentaux. À la fin des Qing et au début de la République, il prospère dans les maisons de thé, porté par des maîtres tels que Zhu Ziqing et Wu Shude.',
                    instrument: 'L\'accompagnement comprend souvent le yangqin, le pipa, le sanxian et la flûte dizi. Les chanteurs marquent aussi le rythme avec les mains, créant le style typique « chanter et frapper ».',
                    costume: 'Traditionnellement, les artistes portent une longue robe blanche ceinturée ; les interprètes féminines ajoutent un châle brodé et des ornements de coiffure pour souligner l\'élégance scénique.',
                    default: 'Je peux vous présenter l\'histoire, le répertoire et les héritiers du Baiju, ou chanter des airs comme {song1} et {song2}. Posez-moi vos questions !',
                    singGeneric: 'Très bien, je vous interprète {song}.',
                    singSong1: 'Avec plaisir. Profitons ensemble de l\'ambiance festive de {song}.',
                    singSong2: 'Bien entendu. Découvrons les quatre saisons de Nankin dans {song}.',
                    singSong3: 'Bien sûr. {song} vous fera goûter aux saveurs de Nankin.'
                }
            },
            'ja': {
                title: 'インタラクティブQ&A',
                userLabel: '来訪者',
                assistantLabel: '伝承者',
                inputPlaceholder: '質問やリクエストを入力してください...',
                sendButton: '送信',
                voiceButtonIdle: '音声で質問',
                voiceButtonListening: '録音を停止',
                autoDetectLabel: '言語を自動認識',
                ttsLabel: '音声で回答',
                detectedLanguageLabel: '認識言語：',
                noDetection: '待機中',
                welcome: 'こんにちは、私は白局のデジタル伝承者です。白局についての質問や演唱のリクエストをどうぞ。',
                listening: '傾聴中です。はっきりとお話しください。',
                recognitionUnsupported: 'このブラウザでは音声認識が利用できません。最新版のChromeまたはEdgeをお試しください。',
                thinking: '少々お待ちください…',
                ttsPlaying: '音声回答を再生しています...',
                ttsStopped: '音声再生を終了しました。',
                error: '申し訳ありません。うまく処理できませんでした。もう一度お試しください。',
                noSpeech: '音声が検出されませんでした。もう一度お試しください。',
                audioCapture: 'マイクにアクセスできません。権限設定を確認してください。',
                networkError: 'ネットワークエラー。接続を確認してください。',
                permissionDenied: 'マイクの権限が拒否されました。ブラウザの設定でマイクへのアクセスを許可してください。',
                serviceNotAllowed: '音声認識サービスが利用できません。後でもう一度お試しください。',
                httpsRequired: '音声認識にはHTTPS接続が必要です。安全な接続を使用してください。',
                languageNames: {
                    'zh-CN': '中国語',
                    'en': '英語',
                    'es': 'スペイン語',
                    'fr': 'フランス語',
                    'ja': '日本語',
                    'ar': 'アラビア語'
                },
                responses: {
                    greeting: 'こんにちは！南京白局デジタルプラットフォームへようこそ。',
                    intro: '白局は南京で生まれた伝統的な語り物の歌芸です。明代に起源をもち、白い長衣を着て演じたことからこの名がつきました。詞は親しみやすく旋律は澄んでおり、国家級非物質文化遺産に指定されています。',
                    history: '白局は明清期の語り芸から発展し、民間の歌や器楽の要素を取り入れました。清末から民国期には茶館の舞台で盛んになり、朱自清や呉樹徳などの伝承者が活躍しました。',
                    instrument: '伴奏には揚琴・琵琶・三弦・笛子などが用いられ、演者は手拍子でリズムを取り、独特の「歌って手で打つ」スタイルを生み出します。',
                    costume: '伝統的な出演者は白い長衣に帯を締め、女性は刺繍のショールや髪飾りを合わせ、清雅な舞台姿を表現します。',
                    default: '白局の歴史や曲目、伝承者についてご紹介したり、{song1}や{song2}などを演唱することもできます。どうぞお気軽にお尋ねください。',
                    singGeneric: '承知しました。{song}をお聴きください。',
                    singSong1: '喜んで。秦淮灯会の華やかさを描く{song}をお届けします。',
                    singSong2: 'かしこまりました。南京の四季を描く{song}を一緒に味わいましょう。',
                    singSong3: 'もちろんです。{song}で南京の味わいをご堪能ください。'
                }
            },
            'ar': {
                title: 'أسئلة تفاعلية',
                userLabel: 'الزائر',
                assistantLabel: 'الوارث',
                inputPlaceholder: 'اكتب سؤالك أو اطلب مقطعاً غنائياً...',
                sendButton: 'إرسال',
                voiceButtonIdle: 'سؤال صوتي',
                voiceButtonListening: 'إيقاف التسجيل',
                autoDetectLabel: 'التعرّف التلقائي على اللغة',
                ttsLabel: 'إجابة صوتية',
                detectedLanguageLabel: 'اللغة المكتشفة:',
                noDetection: 'بانتظار',
                welcome: 'مرحباً، أنا الوريث الرقمي لفن البايجو. يمكنك سؤالي عن البايجو أو طلب مقطع غنائي كلاسيكي.',
                listening: 'أستمع إليك... الرجاء التحدث بوضوح.',
                recognitionUnsupported: 'التعرّف على الصوت غير متاح في هذا المتصفح. يرجى تجربة أحدث نسخة من Chrome أو Edge.',
                thinking: 'دعني أفكر...',
                ttsPlaying: 'جاري تشغيل الإجابة الصوتية...',
                ttsStopped: 'توقفت الإجابة الصوتية.',
                error: 'عذراً، تعذّر المعالجة. حاول مرة أخرى.',
                noSpeech: 'لم يتم اكتشاف صوت. يرجى المحاولة مرة أخرى.',
                audioCapture: 'لا يمكن الوصول إلى الميكروفون. يرجى التحقق من الصلاحيات.',
                networkError: 'خطأ في الشبكة. يرجى التحقق من الاتصال.',
                permissionDenied: 'تم رفض إذن الميكروفون. يرجى السماح بالوصول إلى الميكروفون في إعدادات المتصفح.',
                serviceNotAllowed: 'خدمة التعرف على الصوت غير متاحة. يرجى المحاولة لاحقاً.',
                httpsRequired: 'التعرف على الصوت يتطلب HTTPS. يرجى استخدام اتصال آمن.',
                languageNames: {
                    'zh-CN': 'الصينية',
                    'en': 'الإنجليزية',
                    'es': 'الإسبانية',
                    'fr': 'الفرنسية',
                    'ja': 'اليابانية',
                    'ar': 'العربية'
                },
                responses: {
                    greeting: 'مرحباً! أهلاً بك في المنصة الرقمية لفن البايجو في نانجينغ.',
                    intro: 'البايجو فن غنائي قصصي تقليدي من نانجينغ، ظهر في عهد أسرة مينغ وسُمّي نسبة إلى الثياب البيضاء التي يرتديها المؤدون. كلماته قريبة من الجمهور وألحانه رقيقة، وقد أُدرج ضمن قائمة التراث الثقافي غير المادي الوطني.',
                    history: 'تطور البايجو من فنون السرد في عهدي مينغ وتشينغ، ودمج عناصر من الأغاني الشعبية والآلات الموسيقية. ازدهر في مقاهي الشاي أواخر أسرة تشينغ وبداية الجمهورية، ومن رواده البارزين الأساتذة تشو تسي تشينغ ووو شو ده.',
                    instrument: 'تشمل الآلات المصاحبة عادةً اليانغتشين والبيبا والسانشيان والناي الصيني (دزي). كما يضرب المؤدي الإيقاع بكفيه، فيبرز أسلوب «الغناء مع الإيقاع اليدوي» المميز.',
                    costume: 'يرتدي الفنانون التقليديون أردية بيضاء طويلة مع حزام، وتضيف المؤديات شالات مطرزة وزينة للشعر لإبراز هيئة مسرحية أنيقة.',
                    default: 'يمكنني إطلاعك على تاريخ البايجو ومقاطعه وورّاثه، أو أن أؤدي مقاطع مثل {song1} و{song2}. لا تتردد في طرح سؤالك!',
                    singGeneric: 'بكل سرور، سأؤدي {song} من أجلك.',
                    singSong1: 'حاضر، استمتع بأجواء مهرجان أضواء تشينهواي مع {song}.',
                    singSong2: 'بكل تأكيد، فلنعيش معاً فصول نانجينغ الأربعة في {song}.',
                    singSong3: 'أكيد، {song} سيأخذك في رحلة بين نكهات نانجينغ.'
                }
            }
        };

        const recognitionLangMap = {
            'zh-CN': 'zh-CN',
            'en': 'en-US',
            'es': 'es-ES',
            'fr': 'fr-FR',
            'ja': 'ja-JP',
            'ar': 'ar-SA'
        };

        const ttsLangMap = {
            'zh-CN': 'zh-CN',
            'en': 'en-US',
            'es': 'es-ES',
            'fr': 'fr-FR',
            'ja': 'ja-JP',
            'ar': 'ar-SA'
        };

        const conversationState = {
            autoDetect: true,
            ttsEnabled: true,
            recognitionSupported: 'SpeechRecognition' in window || 'webkitSpeechRecognition' in window,
            speechSupported: 'speechSynthesis' in window,
            recognition: null,
            isListening: false,
            labels: null,
            elements: {},
            currentStatusType: 'idle',
            lastDetectedLang: 'zh-CN',
            initialized: false
        };

        function setupConversation() {
            if (conversationState.initialized) {
                updateConversationLanguage(currentLanguage);
                if (conversationState.autoDetect) {
                    updateDetectedLanguageDisplay(null);
                } else {
                    updateDetectedLanguageDisplay(currentLanguage);
                }
                updateRecognitionLanguage();
                return;
            }

            conversationState.initialized = true;
            conversationState.elements = {
                panel: document.getElementById('feature1-conversation-panel'),
                title: document.getElementById('feature1-conversation-title'),
                autoDetectCheckbox: document.getElementById('feature1-auto-detect'),
                autoLabel: document.getElementById('feature1-auto-label'),
                ttsToggle: document.getElementById('feature1-tts-toggle'),
                ttsLabel: document.getElementById('feature1-tts-label'),
                detectedLanguageLabel: document.getElementById('feature1-detected-language-label'),
                detectedLanguageText: document.getElementById('feature1-detected-language-text'),
                status: document.getElementById('feature1-status-text'),
                chatLog: document.getElementById('feature1-chat-log'),
                voiceBtn: document.getElementById('feature1-voice-btn'),
                input: document.getElementById('feature1-question-input'),
                sendBtn: document.getElementById('feature1-send-btn')
            };

            updateConversationLanguage(currentLanguage);
            resetConversation(currentLanguage);
            initSpeechRecognition();
            updateRecognitionLanguage();

            if (!conversationState.speechSupported && conversationState.elements.ttsToggle) {
                conversationState.ttsEnabled = false;
                conversationState.elements.ttsToggle.checked = false;
                conversationState.elements.ttsToggle.disabled = true;
            }

            if (conversationState.elements.sendBtn) {
                conversationState.elements.sendBtn.addEventListener('click', () => {
                    const value = conversationState.elements.input.value.trim();
                    if (!value) {
                        return;
                    }
                    conversationState.elements.input.value = '';
                    handleUserQuery(value);
                });
            }

            if (conversationState.elements.input) {
                conversationState.elements.input.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter' && !event.shiftKey) {
                        event.preventDefault();
                        const value = conversationState.elements.input.value.trim();
                        if (!value) {
                            return;
                        }
                        conversationState.elements.input.value = '';
                        handleUserQuery(value);
                    }
                });
            }

            if (conversationState.elements.autoDetectCheckbox) {
                conversationState.elements.autoDetectCheckbox.addEventListener('change', (event) => {
                    conversationState.autoDetect = event.target.checked;
                    if (conversationState.autoDetect) {
                        updateDetectedLanguageDisplay(null);
                    } else {
                        updateDetectedLanguageDisplay(currentLanguage);
                    }
                });
            }

            if (conversationState.elements.ttsToggle) {
                conversationState.elements.ttsToggle.addEventListener('change', (event) => {
                    conversationState.ttsEnabled = event.target.checked;
                    if (!conversationState.ttsEnabled) {
                        stopSpeech();
                        setConversationStatus(conversationState.labels.ttsStopped, 'info');
                    }
                });
            }

            if (conversationState.elements.voiceBtn) {
                conversationState.elements.voiceBtn.addEventListener('click', toggleVoiceRecognition);
                if (!conversationState.recognitionSupported) {
                    conversationState.elements.voiceBtn.disabled = true;
                }
            }

            if (!conversationState.recognitionSupported) {
                setConversationStatus(conversationState.labels.recognitionUnsupported, 'info');
            }
        }

        function updateConversationLanguage(lang) {
            const labels = conversationConfigs[lang] || conversationConfigs['zh-CN'];
            conversationState.labels = labels;

            if (conversationState.elements.title) {
                conversationState.elements.title.textContent = labels.title;
            }
            if (conversationState.elements.autoLabel) {
                conversationState.elements.autoLabel.textContent = labels.autoDetectLabel;
            }
            if (conversationState.elements.ttsLabel) {
                conversationState.elements.ttsLabel.textContent = labels.ttsLabel;
            }
            if (conversationState.elements.detectedLanguageLabel) {
                conversationState.elements.detectedLanguageLabel.textContent = labels.detectedLanguageLabel;
            }
            if (conversationState.elements.input) {
                conversationState.elements.input.setAttribute('placeholder', labels.inputPlaceholder);
            }
            if (conversationState.elements.sendBtn) {
                conversationState.elements.sendBtn.textContent = labels.sendButton;
            }

            updateVoiceButtonLabel(conversationState.isListening ? labels.voiceButtonListening : labels.voiceButtonIdle);

            if (conversationState.autoDetect) {
                updateDetectedLanguageDisplay(null);
            } else {
                updateDetectedLanguageDisplay(lang);
            }

            if (!conversationState.recognitionSupported) {
                setConversationStatus(labels.recognitionUnsupported, 'info');
            }
        }

        function resetConversation(lang) {
            const chatLog = conversationState.elements.chatLog;
            if (chatLog) {
                chatLog.innerHTML = '';
            }
            const labels = conversationConfigs[lang] || conversationConfigs['zh-CN'];
            appendChatMessage('assistant', labels.welcome, lang);
            conversationState.lastDetectedLang = lang;
            if (conversationState.autoDetect) {
                updateDetectedLanguageDisplay(null);
            } else {
                updateDetectedLanguageDisplay(lang);
            }
            clearStatusIfMatch('thinking');
        }

        function appendChatMessage(role, text, lang) {
            const chatLog = conversationState.elements.chatLog;
            if (!chatLog) {
                return;
            }
            const message = document.createElement('div');
            message.classList.add('chat-message', role);
            message.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');

            const labelConfig = conversationConfigs[lang] || conversationConfigs[currentLanguage] || conversationConfigs['zh-CN'];
            const name = role === 'user' ? labelConfig.userLabel : labelConfig.assistantLabel;

            const nameEl = document.createElement('div');
            nameEl.classList.add('chat-name');
            nameEl.textContent = name;

            const bubble = document.createElement('div');
            bubble.classList.add('chat-bubble');
            bubble.textContent = text;

            message.appendChild(nameEl);
            message.appendChild(bubble);
            chatLog.appendChild(message);
            chatLog.scrollTop = chatLog.scrollHeight;
        }

        function setConversationStatus(text, type = 'info') {
            conversationState.currentStatusType = type;
            if (conversationState.elements.status) {
                conversationState.elements.status.textContent = text || '';
            }
        }

        function clearStatusIfMatch(type) {
            if (conversationState.currentStatusType === type) {
                setConversationStatus('', 'idle');
            }
        }

        function updateDetectedLanguageDisplay(langCode) {
            const displayEl = conversationState.elements.detectedLanguageText;
            if (!displayEl) {
                return;
            }
            const labels = conversationState.labels || conversationConfigs[currentLanguage] || conversationConfigs['zh-CN'];
            if (!langCode) {
                displayEl.textContent = labels.noDetection;
                return;
            }
            displayEl.textContent = labels.languageNames[langCode] || labels.languageNames[currentLanguage] || langCode;
        }

        function detectConversationLanguage(text) {
            if (!text) {
                return currentLanguage;
            }
            if (/[\u4e00-\u9fff]/.test(text)) {
                return 'zh-CN';
            }
            if (/[\u3040-\u30ff]/.test(text)) {
                return 'ja';
            }
            if (/[\u0600-\u06FF]/.test(text)) {
                return 'ar';
            }
            if (/[ñáéíóúü¡¿]/i.test(text)) {
                return 'es';
            }
            if (/[çàâéèêëîïôûùœæ]/i.test(text)) {
                return 'fr';
            }
            return 'en';
        }

        function getSongDisplayNameByLanguage(langCode, songId) {
            const langData = languageTexts[langCode] || languageTexts[currentLanguage] || languageTexts['zh-CN'];
            const f1 = langData?.f1;
            if (!f1) {
                return songId;
            }
            const map = {
                song1: f1.song1,
                song2: f1.song2,
                song3: f1.song3
            };
            return map[songId] || songId;
        }

        function formatText(template, replacements) {
            if (typeof template !== 'string') {
                return '';
            }
            return template.replace(/\{(\w+)\}/g, (_, key) => {
                return replacements && Object.prototype.hasOwnProperty.call(replacements, key)
                    ? replacements[key]
                    : '';
            });
        }

        function generateAssistantResponse(text, langCode) {
            const config = conversationConfigs[langCode] || conversationConfigs[currentLanguage] || conversationConfigs['zh-CN'];
            const responses = config.responses;
            const lower = text.toLowerCase();
            const normalized = lower.normalize('NFD').replace(/[\u0300-\u036f]/g, '');

            const replacements = {
                song1: getSongDisplayNameByLanguage(langCode, 'song1'),
                song2: getSongDisplayNameByLanguage(langCode, 'song2'),
                song3: getSongDisplayNameByLanguage(langCode, 'song3')
            };

            let messageKey = 'default';
            let songIntent = null;

            if (/(你好|您好|hello|hi|hey|hola|bonjour|salut|こんにちは|こんばんは|やあ|مرحبا|أهلاً|اهلا)/i.test(text)) {
                messageKey = 'greeting';
            } else if (/(白局是什么|介绍|what is|what\'s|what is baiju|qué es|qué es el|qu\'est-ce que|de quoi s\'agit-il|とは|って何|とは何ですか|ما هو|ماهي|ما هي)/i.test(text)) {
                messageKey = 'intro';
            } else if (/(历史|起源|传承|背景|history|origin|story|background|historia|origen|pasado|histoire|origine|歴史|由来|背景|تاريخ|أصل|خلفية)/i.test(text)) {
                messageKey = 'history';
            } else if (/(乐器|伴奏|instrument|instruments|instrumento|instrumentos|instrumentation|楽器|伴奏|آلات|آلة|عزف)/i.test(text)) {
                messageKey = 'instrument';
            } else if (/(服饰|服装|衣着|costume|dress|clothes|attire|vestuario|indumentaria|tenue|衣装|衣服|装い|زي|ملابس|أزياء)/i.test(text)) {
                messageKey = 'costume';
            } else if (/秦淮灯会/.test(text) || /qinhuai/.test(normalized) || /lantern/.test(normalized)) {
                messageKey = 'singSong1';
                songIntent = 'song1';
            } else if (/金陵四季/.test(text) || /jinling/.test(normalized) || /four seasons/.test(normalized) || /seasons/.test(normalized)) {
                messageKey = 'singSong2';
                songIntent = 'song2';
            } else if (/南京美食/.test(text) || /taste of nanjing/.test(normalized) || /nanjing flavors/.test(normalized) || /sabores de nanjing/.test(normalized) || /saveurs de nanjing/.test(normalized) || /南京の味/.test(text) || /نكهات/.test(text)) {
                messageKey = 'singSong3';
                songIntent = 'song3';
            } else if (/(唱|演唱|来一段|唱一段|歌|点歌|sing|song|perform|singing|cantar|cántame|chanter|chante|歌って|歌を|غن|غناء|أد)/i.test(text)) {
                messageKey = 'singGeneric';
                songIntent = 'song1';
            }

            if (songIntent) {
                replacements.song = getSongDisplayNameByLanguage(langCode, songIntent);
                triggerPerformance(songIntent);
            }

            const template = responses[messageKey] || responses.default;
            const finalMessage = formatText(template, replacements);
            return { message: finalMessage, langCode };
        }

        function triggerPerformance(songId) {
            isPerforming = true;
            currentPerformance = songId;
            playPerformance(songId);
        }

        function handleUserQuery(text) {
            if (!text) {
                return;
            }
            if (!conversationState.labels) {
                updateConversationLanguage(currentLanguage);
            }
            const detectedLang = conversationState.autoDetect ? detectConversationLanguage(text) : currentLanguage;
            conversationState.lastDetectedLang = detectedLang;

            if (conversationState.autoDetect) {
                updateDetectedLanguageDisplay(detectedLang);
            } else {
                updateDetectedLanguageDisplay(currentLanguage);
            }

            appendChatMessage('user', text, detectedLang);
            clearStatusIfMatch('listening');
            setConversationStatus(conversationState.labels.thinking, 'thinking');

            const response = generateAssistantResponse(text, detectedLang);
            appendChatMessage('assistant', response.message, detectedLang);

            if (conversationState.ttsEnabled && conversationState.speechSupported) {
                stopSpeech();
                speakText(response.message, detectedLang);
            } else {
                clearStatusIfMatch('thinking');
            }
        }

        function updateRecognitionLanguage() {
            if (!conversationState.recognition) {
                return;
            }
            const lang = recognitionLangMap[currentLanguage] || 'zh-CN';
            conversationState.recognition.lang = lang;
        }

        async function toggleVoiceRecognition() {
            if (!conversationState.recognitionSupported || !conversationState.recognition) {
                setConversationStatus(conversationState.labels.recognitionUnsupported, 'info');
                return;
            }
            
            // 检查HTTPS（移动设备上语音识别需要HTTPS）
            if (location.protocol !== 'https:' && location.hostname !== 'localhost' && location.hostname !== '127.0.0.1') {
                setConversationStatus(conversationState.labels.httpsRequired, 'info');
                return;
            }
            
            if (conversationState.isListening) {
                conversationState.recognition.stop();
                return;
            }
            
            // 检查麦克风权限
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                // 权限已授予，关闭流
                stream.getTracks().forEach(track => track.stop());
            } catch (error) {
                if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
                    setConversationStatus(conversationState.labels.permissionDenied, 'info');
                    return;
                } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {
                    setConversationStatus(conversationState.labels.audioCapture, 'info');
                    return;
                } else {
                    console.error('Microphone access error:', error);
                    setConversationStatus(conversationState.labels.audioCapture, 'info');
                    return;
                }
            }
            
            try {
                conversationState.recognition.lang = recognitionLangMap[currentLanguage] || conversationState.recognition.lang;
                conversationState.recognition.start();
            } catch (error) {
                console.error('Speech recognition start error:', error);
                setConversationStatus(conversationState.labels.error, 'info');
            }
        }

        function initSpeechRecognition() {
            if (!conversationState.recognitionSupported || conversationState.recognition) {
                return;
            }
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRecognition) {
                conversationState.recognitionSupported = false;
                if (conversationState.elements.voiceBtn) {
                    conversationState.elements.voiceBtn.disabled = true;
                }
                return;
            }
            const recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = recognitionLangMap[currentLanguage] || 'zh-CN';

            recognition.onstart = () => {
                conversationState.isListening = true;
                if (conversationState.elements.voiceBtn) {
                    conversationState.elements.voiceBtn.classList.add('listening');
                }
                updateVoiceButtonLabel(conversationState.labels.voiceButtonListening);
                setConversationStatus(conversationState.labels.listening, 'listening');
            };

            recognition.onend = () => {
                conversationState.isListening = false;
                if (conversationState.elements.voiceBtn) {
                    conversationState.elements.voiceBtn.classList.remove('listening');
                }
                updateVoiceButtonLabel(conversationState.labels.voiceButtonIdle);
                if (conversationState.currentStatusType === 'listening') {
                    clearStatusIfMatch('listening');
                }
            };

            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event);
                let errorMessage = conversationState.labels.error;
                
                if (event.error) {
                    switch (event.error) {
                        case 'no-speech':
                            // no-speech 不是严重错误，只是超时，不显示错误消息
                            errorMessage = conversationState.labels.noSpeech;
                            break;
                        case 'audio-capture':
                            errorMessage = conversationState.labels.audioCapture;
                            break;
                        case 'network':
                            errorMessage = conversationState.labels.networkError;
                            break;
                        case 'not-allowed':
                            // 检查是否是权限问题
                            if (event.message && event.message.includes('permission')) {
                                errorMessage = conversationState.labels.permissionDenied;
                            } else {
                                errorMessage = conversationState.labels.serviceNotAllowed;
                            }
                            break;
                        case 'service-not-allowed':
                            errorMessage = conversationState.labels.serviceNotAllowed;
                            break;
                        default:
                            errorMessage = conversationState.labels.error;
                    }
                }
                
                // 对于 no-speech 错误，只在控制台记录，不显示给用户（因为这是正常的超时）
                if (event.error === 'no-speech') {
                    console.log('Speech recognition timeout (no speech detected)');
                    // 不显示错误消息，让用户知道可以重试
                } else {
                    setConversationStatus(errorMessage, 'info');
                }
            };

            recognition.onresult = (event) => {
                const result = event.results && event.results[0] && event.results[0][0]
                    ? event.results[0][0].transcript.trim()
                    : '';
                if (result) {
                    handleUserQuery(result);
                } else {
                    setConversationStatus(conversationState.labels.error, 'info');
                }
            };

            conversationState.recognition = recognition;
        }

        function updateVoiceButtonLabel(text) {
            if (conversationState.elements.voiceBtn) {
                conversationState.elements.voiceBtn.textContent = text;
            }
        }

        function speakText(text, langCode) {
            if (!conversationState.speechSupported) {
                return;
            }
            const synthesis = window.speechSynthesis;
            if (!synthesis) {
                return;
            }
            stopSpeech();
            const utterance = new SpeechSynthesisUtterance(text);
            const targetLang = ttsLangMap[langCode] || ttsLangMap[currentLanguage] || 'zh-CN';
            utterance.lang = targetLang;

            const voices = synthesis.getVoices();
            const matchedVoice = voices.find(voice => voice.lang && voice.lang.toLowerCase().startsWith(targetLang.toLowerCase()));
            if (matchedVoice) {
                utterance.voice = matchedVoice;
            }

            utterance.onend = () => {
                clearStatusIfMatch('tts');
            };

            utterance.onerror = () => {
                clearStatusIfMatch('tts');
                setConversationStatus(conversationState.labels.error, 'info');
            };

            clearStatusIfMatch('thinking');
            setConversationStatus(conversationState.labels.ttsPlaying, 'tts');
            synthesis.speak(utterance);
        }

        function stopSpeech() {
            if (!conversationState.speechSupported) {
                return;
            }
            const synthesis = window.speechSynthesis;
            if (!synthesis) {
                return;
            }
            synthesis.cancel();
            clearStatusIfMatch('tts');
        }

        // 虚拟人物表演功能
        let isPerforming = false;
        let currentPerformance = null;
        
        const video = document.getElementById('virtual-video');

        function playPerformance(songId) {
        	if (!video.paused) {
                video.pause();
            }
            video.currentTime = 0;
            
            // 加载并播放视频
            video.load();
            video.play();

            // 更新表演状态文本
            const performanceText = document.getElementById('performance-text');
            performanceText.textContent = `${languageTexts[currentLanguage].f1.statusPlaying}${getSongName(songId)}`;
        }


        function stopPerformance() {
        	video.pause();
            const performanceText = document.getElementById('performance-text');
            performanceText.textContent = languageTexts[currentLanguage].f1.statusStopped;
        }

        function simulatePerformance(songName, duration) {
            console.log(`开始表演: ${songName}`);
            
            // 更新表演状态
            const performanceText = document.getElementById('performance-text');
            performanceText.textContent = `${languageTexts[currentLanguage].f1.statusPlaying}${songName}...`;
            
            // 模拟歌词显示
            const lyrics = getLyrics(songName);
            let currentLine = 0;
            
            const lyricInterval = setInterval(() => {
                if (!isPerforming) {
                    clearInterval(lyricInterval);
                    return;
                }
                
                if (currentLine < lyrics.length) {
                    performanceText.textContent = lyrics[currentLine];
                    currentLine++;
                }
            }, 2000); // 每2秒换一行歌词
            
            // 表演结束后自动停止
            setTimeout(() => {
                if (isPerforming) {
                    stopPerformance();
                    performanceText.textContent = languageTexts[currentLanguage].f1.performanceEnded;
                    
                    // 3秒后清空文本
                    setTimeout(() => {
                        performanceText.textContent = '';
                    }, 3000);
                }
            }, duration);
        }

        function getLyrics(songName) {
            // 这里保持旧函数未使用，歌词由 f2.sampleLyrics 提供
            return [songName];
        }

        // 选择语言函数
        function selectLanguage(lang) {
            console.log('选择语言:', lang);
            currentLanguage = lang;
            const langConfig = languageTexts[lang] || languageTexts['zh-CN'];
            currentBaseGenreName = langConfig?.genreBaseName || getGenreDisplayName('baiju', lang);
            currentGenre = 'baiju';
            
            if (!conversationState.initialized) {
                setupConversation();
            } else {
                stopSpeech();
                updateConversationLanguage(lang);
                resetConversation(lang);
                updateRecognitionLanguage();
            }
            
            // 更新功能页面的文本
            const featurePage = document.getElementById('feature-page');
            const genrePage = document.getElementById('genre-page');
            const detailModals = document.querySelectorAll('.feature-detail');
            if (lang === 'ar') {
                featurePage.classList.add('arabic-text');
                genrePage.classList.add('arabic-text');
                detailModals.forEach(modal => modal.classList.add('arabic-text'));
            } else {
                featurePage.classList.remove('arabic-text');
                genrePage.classList.remove('arabic-text');
                detailModals.forEach(modal => modal.classList.remove('arabic-text'));
            }
            
            document.getElementById('feature-title').textContent = langConfig.featureTitle;
            document.getElementById('feature-description').textContent = langConfig.featureDescription;
            document.getElementById('feature1-title').textContent = langConfig.feature1Title;
            document.getElementById('feature1-desc').textContent = langConfig.feature1Desc;
            document.getElementById('feature2-title').textContent = langConfig.feature2Title;
            document.getElementById('feature2-desc').textContent = langConfig.feature2Desc;
            document.getElementById('feature3-title').textContent = langConfig.feature3Title;
            document.getElementById('feature3-desc').textContent = langConfig.feature3Desc;
            document.getElementById('feature4-title').textContent = langConfig.feature4Title;
            document.getElementById('feature4-desc').textContent = langConfig.feature4Desc;
            document.getElementById('feature5-title').textContent = langConfig.feature5Title;
            document.getElementById('feature5-desc').textContent = langConfig.feature5Desc;
            const feedbackCard = document.querySelectorAll('.feature-card')[5];  
            feedbackCard.querySelector('h3').textContent = langConfig.feature6Title;  
            feedbackCard.querySelector('p').textContent = langConfig.feature6Desc;
            document.getElementById('back-btn').textContent = langConfig.backToGenres || langConfig.backBtn || '返回曲种选择';
            document.getElementById('help-btn').textContent = langConfig.helpBtn;
            updateGenrePageContent(lang);
            
            // 功能一弹窗文本
            const f1 = langConfig.f1;
            if (f1) {
                document.getElementById('f1-title').textContent = f1.title;
                document.getElementById('f1-desc').textContent = f1.desc;
				const elF1Choose = document.getElementById('f1-choose');
				if (elF1Choose) elF1Choose.textContent = f1.choose;
				const elF1Song1 = document.getElementById('f1-song1');
				if (elF1Song1) elF1Song1.textContent = f1.song1;
				const elF1Song2 = document.getElementById('f1-song2');
				if (elF1Song2) elF1Song2.textContent = f1.song2;
				const elF1Song3 = document.getElementById('f1-song3');
				if (elF1Song3) elF1Song3.textContent = f1.song3;
				const elF1TagClassic = document.getElementById('f1-tag-classic');
				if (elF1TagClassic) elF1TagClassic.textContent = f1.tagClassic;
				const elF1TagClassic2 = document.getElementById('f1-tag-classic-2');
				if (elF1TagClassic2) elF1TagClassic2.textContent = f1.tagClassic;
				const elF1TagModern = document.getElementById('f1-tag-modern');
				if (elF1TagModern) elF1TagModern.textContent = f1.tagModern;
                document.getElementById('f1-btn-play1').innerHTML = `<i class="fas fa-play"></i> ${f1.btnPlayPrefix}${f1.song1}${f1.btnPlaySuffix}`;
                document.getElementById('f1-btn-play2').innerHTML = `<i class="fas fa-play"></i> ${f1.btnPlayPrefix}${f1.song2}${f1.btnPlaySuffix}`;
                document.getElementById('f1-btn-stop').innerHTML = `<i class="fas fa-stop"></i> ${f1.btnStop}`;
            }

            // 功能二弹窗文本
            const f2 = langConfig.f2;
            if (f2) {
                document.getElementById('f2-title').textContent = f2.title;
                document.getElementById('f2-desc').textContent = f2.desc;
                document.getElementById('f2-choose').textContent = f2.choose;
                document.getElementById('f2-lyrics-title').textContent = f2.lyricsTitle;
                document.getElementById('f2-btn-song1').textContent = f2.song1;
                document.getElementById('f2-btn-song2').textContent = f2.song2;
                document.getElementById('f2-btn-song3').textContent = f2.song3;
                document.getElementById('label-pitch').textContent = f2.pitch;
                document.getElementById('label-rhythm').textContent = f2.rhythm;
                document.getElementById('label-pronunciation').textContent = f2.pronunciation;
                document.getElementById('start-singing').textContent = f2.start;
                // 初始化歌词为 song1
                setTrainingLyrics('song1');
            }

            // 功能三弹窗文本
            const f3 = langConfig.f3;
            if (f3) {
                document.getElementById('f3-title').textContent = f3.title;
                document.getElementById('f3-desc').textContent = f3.desc;
                document.getElementById('f3-scene-title').textContent = f3.sceneTitle;
                document.getElementById('f3-scene-sub').textContent = f3.sceneSub;
                document.getElementById('f3-courses-title').textContent = f3.coursesTitle;
                document.getElementById('f3-course1-title').textContent = f3.course1Title;
                document.getElementById('f3-course1-desc').textContent = f3.course1Desc;
                document.getElementById('f3-course2-title').textContent = f3.course2Title;
                document.getElementById('f3-course2-desc').textContent = f3.course2Desc;
                document.getElementById('f3-course3-title').textContent = f3.course3Title;
                document.getElementById('f3-course3-desc').textContent = f3.course3Desc;
                document.getElementById('f3-qa-title').textContent = f3.qaTitle;
                document.getElementById('f3-qa-input').setAttribute('placeholder', f3.qaPlaceholder);
                document.getElementById('f3-qa-btn').textContent = f3.qaBtn;
            }

            // 功能四弹窗文本
            const f4 = langConfig.f4;
            if (f4) {
                document.getElementById('f4-title').textContent = f4.title;
                document.getElementById('f4-desc').textContent = f4.desc;
                document.getElementById('f4-card1-title').textContent = f4.card1Title;
                document.getElementById('f4-card1-desc').textContent = f4.card1Desc;
                document.getElementById('f4-card2-title').textContent = f4.card2Title;
                document.getElementById('f4-card2-desc').textContent = f4.card2Desc;
                document.getElementById('f4-card3-title').textContent = f4.card3Title;
                document.getElementById('f4-card3-desc').textContent = f4.card3Desc;
                document.getElementById('f4-card4-title').textContent = f4.card4Title;
                document.getElementById('f4-card4-desc').textContent = f4.card4Desc;
                document.getElementById('f4-card1-btn').textContent = f4.more;
                document.getElementById('f4-card2-btn').textContent = f4.more;
                document.getElementById('f4-card3-btn').textContent = f4.more;
                document.getElementById('f4-card4-btn').textContent = f4.more;
                document.getElementById('f4-lang-title').textContent = f4.langTitle;
            }

            // 功能五弹窗文本
            const f5 = langConfig.f5;
            if (f5) {
                document.getElementById('f5-title').textContent = f5.title;
                document.getElementById('f5-desc').textContent = f5.desc;
                document.getElementById('f5-input-title').textContent = f5.inputTitle;
                document.getElementById('f5-input').setAttribute('placeholder', f5.inputPlaceholder);
                document.getElementById('f5-select-lang-title').textContent = f5.selectLangTitle;
                document.getElementById('f5-generate-btn').textContent = f5.generateBtn;
                document.getElementById('f5-output-title').textContent = f5.outputTitle;
                document.getElementById('creation-text').textContent = f5.resultPlaceholder;
                document.getElementById('f5-preview-btn').textContent = f5.previewBtn;
                document.getElementById('f5-share-btn').textContent = f5.shareBtn;
            }

            // 功能六弹窗文本
            const f6 = langConfig.f6;
            if (f6) {
                document.getElementById('f6-title').textContent = f6.title;
                document.getElementById('f6-desc').textContent = f6.desc;
                document.getElementById('f6-type-label').textContent = f6.typeLabel;
                document.getElementById('f6-type-suggestion').textContent = f6.typeSuggestion;
                document.getElementById('f6-type-bug').textContent = f6.typeBug;
                document.getElementById('f6-type-content').textContent = f6.typeContent;
                document.getElementById('f6-type-other').textContent = f6.typeOther;
                document.getElementById('f6-title-label').textContent = f6.titleLabel;
                document.getElementById('feedback-title').setAttribute('placeholder', f6.titlePlaceholder);
                document.getElementById('f6-content-label').textContent = f6.contentLabel;
                document.getElementById('feedback-content').setAttribute('placeholder', f6.contentPlaceholder);
                document.getElementById('f6-contact-label').textContent = f6.contactLabel;
                document.getElementById('contact-info').setAttribute('placeholder', f6.contactPlaceholder);
                document.getElementById('f6-rating-label').textContent = f6.ratingLabel;
                document.getElementById('rating-text').textContent = f6.ratingText;
                document.getElementById('f6-submit-btn').textContent = f6.submitBtn;
                document.getElementById('f6-history-title').textContent = f6.historyTitle;
            }

            // 刷新基线文本（切换语言后需要更新）
            replaceTextIds.forEach(id => {
                const el = document.getElementById(id);
                if (el) originalTexts[id] = el.textContent;
            });

            applyGenreTexts();

            // 语言选择完成，进入曲种选择页
            document.getElementById('language-page').classList.remove('active');
            document.getElementById('genre-page').style.display = ''; // 确保可见
            document.getElementById('genre-page').classList.add('active');
        }

        // 选择曲种后进入功能展示页面（暂时与白局相同）
        function selectGenre(genre) {
            console.log('选择曲种:', genre);
            currentGenre = genre;
            // 更新功能页返回按钮文字
            const backBtn = document.getElementById('back-btn');
            if (backBtn) {
                const langConfig = languageTexts[currentLanguage] || languageTexts['zh-CN'];
                backBtn.textContent = langConfig?.backToGenres || langConfig?.backBtn || '返回曲种选择';
            }
            // 进入功能页
            document.getElementById('genre-page').classList.remove('active');
            const pageKun = document.getElementById('feature-page-kunqu');
            const pagePin = document.getElementById('feature-page-pintang');
            const pageYan = document.getElementById('feature-page-yangju');
            document.getElementById('feature-page').classList.add('active');
            document.getElementById('feature-page').style.display = '';
            if (pageKun) {
                pageKun.classList.remove('active');
                pageKun.style.display = 'none';
            }
            if (pagePin) {
                pagePin.classList.remove('active');
                pagePin.style.display = 'none';
            }
            if (pageYan) {
                pageYan.classList.remove('active');
                pageYan.style.display = 'none';
            }
            applyGenreTexts();
        }

        // 根据当前曲种，动态调整页面标题及涉及"白局"的文案
        function applyGenreTexts() {
            const langConfig = languageTexts[currentLanguage] || languageTexts['zh-CN'];
            const baseName = langConfig?.genreBaseName || currentBaseGenreName || getGenreDisplayName('baiju', currentLanguage);
            const displayName = getGenreDisplayName(currentGenre, currentLanguage);
            const baseNameReg = baseName ? new RegExp(escapeRegExp(baseName), 'g') : null;
            
            // 更新关怀模式文案的辅助函数
            function updateCareModeText(el, elementId) {
                if (!el || !el.hasAttribute('data-simple')) return;
                
                const currentSimple = el.getAttribute('data-simple') || '';
                if (!currentSimple) return;
                
                // 对于特定元素，使用更精确的替换逻辑
                if (elementId === 'feature-title') {
                    // 标题：根据曲种生成对应的关怀模式标题
                    const titleMap = {
                        'baiju': '白局数字平台',
                        'kunqu': '昆曲数字平台',
                        'pintang': '评弹数字平台',
                        'yangju': '扬剧数字平台'
                    };
                    if (titleMap[currentGenre]) {
                        el.setAttribute('data-simple', titleMap[currentGenre]);
                    }
                }
                else if (elementId === 'feature-description') {
                    // 描述：根据曲种生成对应的关怀模式描述
                    const descMap = {
                        'baiju': '探索南京白局的数字体验',
                        'kunqu': '探索昆曲的数字体验',
                        'pintang': '探索评弹的数字体验',
                        'yangju': '探索扬剧的数字体验'
                    };
                    if (descMap[currentGenre]) {
                        el.setAttribute('data-simple', descMap[currentGenre]);
                    }
                }
                // 如果包含基线名称（如"白局"），则替换为当前曲种名称
                else if (baseNameReg && baseName && currentSimple.includes(baseName)) {
                    let newSimple = currentSimple.replace(baseNameReg, displayName);
                    // 如果当前剧种不是白局，需要移除"南京"前缀
                    if (currentGenre !== 'baiju') {
                        // 移除"南京"前缀（支持多种语言）
                        newSimple = newSimple.replace(/南京/g, '')
                                             .replace(/Nanjing\s+/gi, '')
                                             .replace(/Nankín\s+/gi, '')
                                             .replace(/\s+de\s+Nankín/gi, '')
                                             .replace(/\s+de\s+Nanjing/gi, '')
                                             .replace(/نانجينغ\s+/gi, '')
                                             .replace(/\s+نانجينغ\s+الرقمية/gi, ' الرقمية')
                                             .replace(/\s+/g, ' ')
                                             .trim();
                    }
                    el.setAttribute('data-simple', newSimple);
                }
                else if (elementId === 'feature1-desc') {
                    // 虚拟演唱描述
                    const descMap = {
                        'baiju': '虚拟形象演唱白局',
                        'kunqu': '虚拟形象演唱昆曲',
                        'pintang': '虚拟形象演唱评弹',
                        'yangju': '虚拟形象演唱扬剧'
                    };
                    if (descMap[currentGenre]) {
                        el.setAttribute('data-simple', descMap[currentGenre]);
                    }
                }
                else if (elementId === 'feature4-desc') {
                    // 知识库描述
                    const descMap = {
                        'baiju': '了解白局的起源与人物',
                        'kunqu': '了解昆曲的起源与人物',
                        'pintang': '了解评弹的起源与人物',
                        'yangju': '了解扬剧的起源与人物'
                    };
                    if (descMap[currentGenre]) {
                        el.setAttribute('data-simple', descMap[currentGenre]);
                    }
                }
            }
            
            // 主标题与简介：如果基线存在基线名称，则替换；否则使用模板
            const titleEl = document.getElementById('feature-title');
            if (titleEl) {
                const base = originalTexts['feature-title'] || titleEl.textContent;
                let newTitle;
                if (baseNameReg && baseName && base.includes(baseName)) {
                    newTitle = base.replace(baseNameReg, displayName);
                } else {
                    newTitle = getGenreTitle(currentLanguage, currentGenre);
                }
                titleEl.textContent = newTitle;
                // 更新关怀模式文案前，先更新data-original（如果存在）
                if (titleEl.hasAttribute('data-original')) {
                    titleEl.setAttribute('data-original', newTitle);
                }
                // 更新关怀模式文案
                updateCareModeText(titleEl, 'feature-title');
            }
            const descEl = document.getElementById('feature-description');
            if (descEl) {
                const base = originalTexts['feature-description'] || descEl.textContent;
                let newDesc;
                if (baseNameReg && baseName && base.includes(baseName)) {
                    newDesc = base.replace(baseNameReg, displayName);
                    // 如果当前剧种不是白局，需要移除"南京"前缀
                    if (currentGenre !== 'baiju') {
                        // 移除描述中的"南京"前缀（支持多种语言）
                        newDesc = newDesc.replace(/南京/g, '')
                                         .replace(/Nanjing\s+/gi, '')
                                         .replace(/Nankín\s+/gi, '')
                                         .replace(/\s+de\s+Nankín/gi, '')
                                         .replace(/\s+de\s+Nanjing/gi, '')
                                         .replace(/نانجينغ\s+/gi, '')
                                         .replace(/\s+نانجينغ\s+الرقمية/gi, ' الرقمية')
                                         .replace(/\s+/g, ' ')
                                         .trim();
                    }
                } else {
                    // 只有白局显示"南京"，其他剧种不显示
                    let descDisplayName = displayName;
                    if (currentGenre !== 'baiju') {
                        // 移除描述中的"南京"前缀
                        descDisplayName = displayName.replace(/^南京/, '').replace(/^Nanjing\s*/i, '').replace(/^Nankín\s*/i, '').replace(/^نانجينغ\s*/i, '').trim();
                    }
                    const defaultDescTemplates = {
                        'zh-CN': currentGenre === 'baiju' 
                            ? `探索南京${descDisplayName}的数字化体验，感受传统与现代科技的融合`
                            : `探索${descDisplayName}的数字化体验，感受传统与现代科技的融合`,
                        'en': `Explore the digital experience of ${descDisplayName} intangible cultural heritage, feel the integration of tradition and modern technology`,
                        'es': `Explore la experiencia digital del patrimonio cultural inmaterial de ${descDisplayName} y sienta la unión entre tradición y tecnología moderna`,
                        'fr': `Explorez l'expérience numérique du patrimoine culturel immatériel de ${descDisplayName} et ressentez la fusion entre tradition et technologie moderne`,
                        'ja': `${descDisplayName}の無形文化遺産デジタル体験を探り、伝統と現代技術の融合を感じましょう`,
                        'ar': `استكشف التجربة الرقمية لتراث ${descDisplayName} الثقافي غير المادي وشاهد تكامل التقاليد مع التكنولوجيا الحديثة`
                    };
                    newDesc = defaultDescTemplates[currentLanguage] || `Explore the digital experience of ${descDisplayName}.`;
                }
                descEl.textContent = newDesc;
                // 更新关怀模式文案前，先更新data-original（如果存在）
                if (descEl.hasAttribute('data-original')) {
                    descEl.setAttribute('data-original', newDesc);
                }
                // 更新关怀模式文案
                updateCareModeText(descEl, 'feature-description');
            }
            // 替换部分包含"白局"的功能描述/弹窗描述
            replaceTextIds.forEach(id => {
                if (id === 'feature-title' || id === 'feature-description') return;
                const el = document.getElementById(id);
                if (!el) return;
                const base = originalTexts[id] || el.textContent;
                let newText;
                if (baseNameReg && baseName && base.includes(baseName)) {
                    newText = base.replace(baseNameReg, displayName);
                } else {
                    newText = base;
                }
                el.textContent = newText;
                // 更新关怀模式文案前，先更新data-original（如果存在）
                if (el.hasAttribute('data-original')) {
                    el.setAttribute('data-original', newText);
                }
                // 更新关怀模式文案
                updateCareModeText(el, id);
            });
            
            // 如果关怀模式已开启，需要重新应用以更新显示的文案
            if (document.documentElement.classList.contains('care-mode') && typeof swapSimpleText === 'function') {
                swapSimpleText(true);
            }
        }

        // 显示功能详情
        function showFeatureDetail(featureId) {
            // 显示遮罩层
            document.getElementById('overlay').classList.add('active');
            
            // 隐藏所有功能详情
            document.querySelectorAll('.feature-detail').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // 显示选中的功能详情
            document.getElementById(`${featureId}-detail`).classList.add('active');
            
            // 如果是社会治理数据大屏，初始化图表
            if (featureId === 'feature7') {
                setTimeout(() => {
                    initGovernanceDashboard();
                    // 每5秒更新一次数据
                    if (!window.dashboardUpdateInterval) {
                        window.dashboardUpdateInterval = setInterval(updateDashboardData, 5000);
                    }
                    // 窗口大小改变时重绘图表
                    window.addEventListener('resize', drawParticipationChart);
                }, 100);
            }
        }

        // 关闭功能详情
        function closeFeatureDetail(featureId) {
            // 隐藏遮罩层
            document.getElementById('overlay').classList.remove('active');
            const activeId = document.getElementById(`${featureId}-detail-${currentGenre}`) ? 
                `${featureId}-detail-${currentGenre}` : `${featureId}-detail`;
            document.getElementById(activeId).classList.remove('active');
        }

        // 从功能页面返回（回到曲种选择页面）
        function goBackToLanguage() {
            console.log('返回曲种选择');
            document.getElementById('feature-page').classList.remove('active');
            const pageKun = document.getElementById('feature-page-kunqu');
            const pagePin = document.getElementById('feature-page-pintang');
            const pageYan = document.getElementById('feature-page-yangju');
            if (pageKun) pageKun.classList.remove('active');
            if (pagePin) pagePin.classList.remove('active');
            if (pageYan) pageYan.classList.remove('active');
            document.getElementById('genre-page').classList.add('active');
            currentGenre = 'baiju';
            applyGenreTexts();
            
            // 关闭所有功能详情
            document.querySelectorAll('.feature-detail').forEach(detail => {
                detail.classList.remove('active');
            });
            
            // 隐藏遮罩层
            document.getElementById('overlay').classList.remove('active');
        }

        // 从曲种选择页面返回到语言选择
        function goBackToLanguageFromGenre() {
            console.log('返回语言选择');
            document.getElementById('genre-page').classList.remove('active');
            document.getElementById('language-page').classList.add('active');
            currentGenre = 'baiju';
            applyGenreTexts();
        }

        // 选择唱段
        function selectSong(songId) {
            console.log('选择唱段:', songId);
            // 可以选择唱段但不立即播放
            const performanceText = document.getElementById('performance-text');
            const f1 = languageTexts[currentLanguage].f1;
            performanceText.textContent = `${f1.statusSelected}${getSongName(songId)}${f1.statusHint}`;
        }

        function getSongName(songId) {
            const f1 = languageTexts[currentLanguage].f1;
            const map = {
                'song1': f1 ? f1.song1 : 'song1',
                'song2': f1 ? f1.song2 : 'song2',
                'song3': f1 ? f1.song3 : 'song3'
            };
            const name = map[songId] || 'Unknown';
            // 返回不带引号的名称，在按钮里已处理引号
            return name;
        }

        // 选择训练唱段
        function selectTrainingSong(songId) {
            console.log('选择训练唱段:', songId);
            setTrainingLyrics(songId);
        }

        function setTrainingLyrics(songId) {
            const f2 = languageTexts[currentLanguage].f2;
            const key = songId;
            const lines = (f2 && f2.sampleLyrics && f2.sampleLyrics[key]) ? f2.sampleLyrics[key] : [];
            const lyrics = document.getElementById('lyrics-display');
            if (lines.length) {
                lyrics.innerHTML = lines.map(line => `<div class="lyric-line">${line}</div>`).join('');
            } else {
                lyrics.innerHTML = `<div class="lyric-line">...</div>`;
            }
        }

        // 选择课程
        function selectCourse(courseId) {
            console.log('选择课程:', courseId);
            // 这里可以加载课程内容
        }
        
        function initStarRating() {
            const stars = document.querySelectorAll('.star');
            const ratingText = document.getElementById('rating-text');
            let selectedRating = 0;

            stars.forEach(star => {
                star.addEventListener('mouseover', function() {
                    const rating = parseInt(this.getAttribute('data-rating'));
                    stars.forEach((s, index) => {
                        if (index < rating) {
                            s.classList.add('hover');
                        } else {
                            s.classList.remove('hover');
                        }
                    });
                });
            });

            document.querySelector('.rating-stars').addEventListener('mouseout', function() {
                stars.forEach((s, index) => {
                    if (index < selectedRating) {
                        s.classList.add('active');
                        s.classList.remove('hover');
                    } else {
                        s.classList.remove('active');
                        s.classList.remove('hover');
                    }
                });
            });

            stars.forEach(star => {
                star.addEventListener('click', function() {
                    selectedRating = parseInt(this.getAttribute('data-rating'));
                    stars.forEach((s, index) => {
                        if (index < selectedRating) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                    ratingText.textContent = `评分: ${selectedRating}星`;
                });
            });
        }

        // 帮助按钮点击事件
        function showHelp() {
            let message = '';
            if (currentLanguage === 'zh-CN') {
                message = '如需帮助，请联系我们的客服团队。\n电话: 400-123-4567\n邮箱: support@baiju-nj.com';
            } else if (currentLanguage === 'en') {
                message = 'For assistance, please contact our customer service team.\nPhone: 400-123-4567\nEmail: support@baiju-nj.com';
            } else if (currentLanguage === 'es') {
                message = 'Para obtener ayuda, comuníquese con nuestro equipo de servicio al cliente.\nTeléfono: 400-123-4567\nCorreo electrónico: support@baiju-nj.com';
            } else if (currentLanguage === 'fr') {
                message = 'Pour obtenir de l\'aide, veuillez contacter notre équipe de service client.\nTéléphone: 400-123-4567\nEmail: support@baiju-nj.com';
            } else if (currentLanguage === 'ja') {
                message = 'サポートが必要な場合は、カスタマーサービスチームまでお問い合わせください。\n電話: 400-123-4567\nメール: support@baiju-nj.com';
            } else if (currentLanguage === 'ar') {
                message = 'للحصول على المساعدة، يرجى الاتصال بفريق خدمة العملاء.\nهاتف: 400-123-4567\nالبريد الإلكتروني: support@baiju-nj.com';
            }
            alert(message);
        }
        // 兼容已有按钮（白局页）
        const helpBtnLegacy = document.getElementById('help-btn');
        if (helpBtnLegacy) {
            helpBtnLegacy.addEventListener('click', showHelp);
        }

        // 导航帮助链接
        document.getElementById('help-nav').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('help-btn').click();
        });

        // 提交反馈函数
        function submitFeedback() {
            const type = document.getElementById('feedback-type').value;
            const title = document.getElementById('feedback-title').value;
            const content = document.getElementById('feedback-content').value;
            const contact = document.getElementById('contact-info').value;
            const rating = document.querySelectorAll('.star.active').length;
            
            if (!title || !content) {
                alert(currentLanguage === 'zh-CN' ? '请填写标题和详细内容' : 'Please fill in title and content');
                return;
            }
            
            // 这里可以添加实际的提交逻辑（发送到服务器）
            console.log('提交反馈:', { type, title, content, contact, rating });
            
            // 显示成功消息
            alert(currentLanguage === 'zh-CN' ? 
                '反馈提交成功！感谢您的宝贵意见。' : 
                'Feedback submitted successfully! Thank you for your valuable feedback.');
            
            // 清空表单
            document.getElementById('feedback-title').value = '';
            document.getElementById('feedback-content').value = '';
            document.getElementById('contact-info').value = '';
            document.querySelectorAll('.star').forEach(star => star.classList.remove('active'));
            document.getElementById('rating-text').textContent = currentLanguage === 'zh-CN' ? '请选择评分' : 'Please select rating';
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面加载完成');
            // 确保语言选择页面是激活状态
            document.getElementById('language-page').classList.add('active');
            document.getElementById('genre-page').classList.remove('active');
            document.getElementById('genre-page').style.display = 'none';
            document.getElementById('feature-page').classList.remove('active');

            // 初始化基线文本
            replaceTextIds.forEach(id => {
                const el = document.getElementById(id);
                if (el) originalTexts[id] = el.textContent;
            });
            
            // 初始化语言选项点击事件
            document.querySelectorAll('.lang-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.lang-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    this.classList.add('active');
                });
                initStarRating();
            });
            
            
            
            // 初始化跟唱按钮
            document.getElementById('start-singing').addEventListener('click', function() {
                // 模拟跟唱评分过程
                const lyrics = document.querySelectorAll('.lyric-line');
                lyrics.forEach((line, index) => {
                    setTimeout(() => {
                        line.classList.add(index % 2 === 0 ? 'correct' : 'incorrect');
                    }, 1000 * (index + 1));
                });
                
                // 更新评分
                setTimeout(() => {
                    document.getElementById('pitch-score').textContent = Math.floor(Math.random() * 20 + 80);
                    document.getElementById('rhythm-score').textContent = Math.floor(Math.random() * 20 + 75);
                    document.getElementById('pronunciation-score').textContent = Math.floor(Math.random() * 20 + 85);
                }, 5000);
            });
        });
        
        // ========== 社会治理功能相关函数 ==========
        
        // 切换浮动按钮菜单
        function toggleGovernanceFab() {
            const fabMain = document.getElementById('governance-fab-main');
            const fabMenu = document.getElementById('governance-fab-menu');
            
            if (fabMain && fabMenu) {
                fabMain.classList.toggle('active');
                fabMenu.classList.toggle('active');
            }
        }
        
        // 点击菜单项后关闭菜单
        document.addEventListener('DOMContentLoaded', function() {
            const fabItems = document.querySelectorAll('.governance-fab-item');
            fabItems.forEach(item => {
                item.addEventListener('click', function() {
                    setTimeout(() => {
                        const fabMain = document.getElementById('governance-fab-main');
                        const fabMenu = document.getElementById('governance-fab-menu');
                        if (fabMain && fabMenu) {
                            fabMain.classList.remove('active');
                            fabMenu.classList.remove('active');
                        }
                    }, 300);
                });
            });
            
            // 点击页面其他地方时关闭菜单
            document.addEventListener('click', function(e) {
                const fab = document.querySelector('.governance-fab');
                const fabMain = document.getElementById('governance-fab-main');
                const fabMenu = document.getElementById('governance-fab-menu');
                
                if (fab && fabMain && fabMenu && fabMenu.classList.contains('active')) {
                    if (!fab.contains(e.target)) {
                        fabMain.classList.remove('active');
                        fabMenu.classList.remove('active');
                    }
                }
            });
        });
        
        // 标签页切换
        function switchTab(tabName) {
            // 隐藏所有标签页内容
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // 移除所有标签按钮的active状态
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.borderBottom = 'none';
                btn.style.color = 'var(--text-light)';
            });
            
            // 显示选中的标签页
            document.getElementById(`${tabName}-tab`).style.display = 'block';
            
            // 激活对应的标签按钮
            const activeBtn = event.target.closest('.tab-btn');
            if (activeBtn) {
                activeBtn.classList.add('active');
                activeBtn.style.borderBottom = '2px solid var(--primary)';
                activeBtn.style.color = 'var(--primary)';
                activeBtn.style.fontWeight = 'bold';
            }
        }
        
        // 提交志愿者报名
        function submitVolunteer() {
            const name = document.getElementById('volunteer-name').value;
            const phone = document.getElementById('volunteer-phone').value;
            const email = document.getElementById('volunteer-email').value;
            const interest = document.getElementById('volunteer-interest').value;
            const experience = document.getElementById('volunteer-experience').value;
            
            if (!name || !phone || !email || !interest) {
                alert('请填写完整信息');
                return;
            }
            
            // 这里应该发送到后端API
            console.log('志愿者报名信息:', { name, phone, email, interest, experience });
            
            alert('报名成功！我们会尽快与您联系。');
            
            // 清空表单
            document.getElementById('volunteer-name').value = '';
            document.getElementById('volunteer-phone').value = '';
            document.getElementById('volunteer-email').value = '';
            document.getElementById('volunteer-interest').value = '';
            document.getElementById('volunteer-experience').value = '';
        }
        
        // 参加活动
        function joinActivity(activityId) {
            const activityNames = {
                1: '白局文化进社区',
                2: '非遗文化体验日',
                3: '线上文化讲座'
            };
            
            if (confirm(`确定要报名参加"${activityNames[activityId]}"活动吗？`)) {
                // 这里应该发送到后端API
                console.log('报名活动:', activityId);
                alert('报名成功！活动详情将发送到您的邮箱。');
            }
        }
        
        // 提交投票
        function submitVote(decisionId) {
            const selectedOption = document.querySelector(`input[name="decision${decisionId}"]:checked`);
            
            if (!selectedOption) {
                alert('请先选择一个选项');
                return;
            }
            
            // 这里应该发送到后端API
            console.log('投票信息:', { decisionId, option: selectedOption.value });
            alert('投票成功！感谢您的参与。');
        }
        
        // 提交建议
        function submitSuggestion() {
            const suggestion = event.target.previousElementSibling.value;
            
            if (!suggestion || suggestion.trim() === '') {
                alert('请输入您的建议');
                return;
            }
            
            // 这里应该发送到后端API
            console.log('建议内容:', suggestion);
            alert('建议提交成功！我们会认真考虑您的意见。');
            event.target.previousElementSibling.value = '';
        }
        
        // 初始化数据大屏图表
        function initGovernanceDashboard() {
            // 模拟数据更新
            updateDashboardData();
            
            // 绘制参与度趋势图（简化版，实际应使用Chart.js等库）
            drawParticipationChart();
        }
        
        // 更新数据大屏数据
        function updateDashboardData() {
            // 模拟实时数据更新
            const stats = {
                totalUsers: 12458 + Math.floor(Math.random() * 100),
                trainingHours: 8642 + Math.floor(Math.random() * 50),
                volunteers: 356 + Math.floor(Math.random() * 10),
                satisfaction: (4.8 + Math.random() * 0.2).toFixed(1)
            };
            
            // 更新显示（如果元素存在）
            const totalUsersEl = document.getElementById('total-users');
            if (totalUsersEl) {
                totalUsersEl.textContent = stats.totalUsers.toLocaleString();
            }
            
            const trainingHoursEl = document.getElementById('training-hours');
            if (trainingHoursEl) {
                trainingHoursEl.textContent = stats.trainingHours.toLocaleString();
            }
            
            const volunteersEl = document.getElementById('volunteers');
            if (volunteersEl) {
                volunteersEl.textContent = stats.volunteers;
            }
            
            const satisfactionEl = document.getElementById('satisfaction');
            if (satisfactionEl) {
                satisfactionEl.textContent = stats.satisfaction;
            }
        }
        
        // 绘制参与度趋势图（简化版）
        function drawParticipationChart() {
            const canvas = document.getElementById('participation-canvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width = canvas.offsetWidth;
            const height = canvas.height = canvas.offsetHeight;
            
            // 模拟数据
            const data = [120, 135, 148, 162, 175, 189, 205, 220, 235, 250, 268, 285];
            const maxValue = Math.max(...data);
            const padding = 40;
            const chartWidth = width - padding * 2;
            const chartHeight = height - padding * 2;
            
            // 清空画布
            ctx.clearRect(0, 0, width, height);
            
            // 绘制背景网格
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(width - padding, y);
                ctx.stroke();
            }
            
            // 绘制折线
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;
            ctx.beginPath();
            data.forEach((value, index) => {
                const x = padding + (chartWidth / (data.length - 1)) * index;
                const y = padding + chartHeight - (value / maxValue) * chartHeight;
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // 绘制数据点
            ctx.fillStyle = '#667eea';
            data.forEach((value, index) => {
                const x = padding + (chartWidth / (data.length - 1)) * index;
                const y = padding + chartHeight - (value / maxValue) * chartHeight;
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
    </script>
    <script src="js/accessibility.js"></script>
</body>
</html>
